<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Zhang Chengbo" />


<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Zhang Chengbo</h4>
<h4 class="date">2023-12-5</h4>



<div id="question" class="section level1">
<h1>Question</h1>
<div id="question1" class="section level2">
<h2>Question1</h2>
<p>试利用逆变换方法构造一个函数复现<code>sample</code>函数在有放回的抽样中的功能
(即参数replace=T)。</p>
</div>
<div id="question2" class="section level2">
<h2>Question2</h2>
<p>标准Laplace分布具有如下的概率密度函数 <span class="math inline">\(f(x)=\frac{1}{2}\exp\{-\left\lvert x \right\rvert
\} \,,x\in\mathbb{R}\)</span>,请使用逆变换方法在该分布下
产生样本容量为1000的随机样本，并使用本章节的其中一种方法将生成的样本集与理论上给定的分布进行对比。</p>
</div>
<div id="question3" class="section level2">
<h2>Question3</h2>
<p>请利用接受-拒绝方法来编写一个函数来产生一个样本容量为n的服从<span class="math inline">\(Beta(a,b)\)</span>的随机样本，并生成一个样本容量为n的服从<span class="math inline">\(Beta(3,2)\)</span>的随机样本，画出该样本的直方图并与<span class="math inline">\(Beta(3,2)\)</span>的理论分布进行比较。</p>
</div>
<div id="question4" class="section level2">
<h2>Question4</h2>
<p>重标定的<em>Epanechnikov</em>核函数具有对称的概率密度函数，<span class="math display">\[
f_e(x)=\frac{3}{4}\left(1-x^2\right), \quad|x| \leq 1\]</span>
<em>Devroye</em>
和<em>Gyorfi</em>给出了以下算法来模拟这种分布。我们先生成独立同分布的
<span class="math inline">\(U_1, U_2, U_3\sim
Uniform(-1,1)\)</span>。</p>
<p>如果<span class="math inline">\(\left\lvert U_3 \right\rvert \geq
\left\lvert U_2\right\rvert\)</span> 并且<span class="math inline">\(\left\lvert U_3 \right\rvert \geq \left\lvert
U_1\right\rvert\)</span>，则输出 <span class="math inline">\(U_2\)</span>；否则输出 <span class="math inline">\(U_3\)</span>。请编写一个函数，从 <span class="math inline">\(f_e\)</span>
生成随机变量，并构建一个用于模拟随机大样本的直方图密度估计。</p>
</div>
<div id="question5" class="section level2">
<h2>Question5</h2>
<p>证明练习 3.9(Question 4) 中给出的算法能从密度函数 <span class="math inline">\(f_e\)</span> 中生成变量。</p>
</div>
</div>
<div id="answer" class="section level1">
<h1>Answer</h1>
<div id="answer1" class="section level2">
<h2>Answer1</h2>
<p>对于<code>sample</code>函数,主要参数有样本抽样选取范围<span class="math inline">\(n\)</span>，样本容量<span class="math inline">\(size\)</span>, 是否放回抽样<span class="math inline">\(replace\)</span>,每个抽样点的抽取概率<span class="math inline">\(prob\)</span>四个，我们在有放回的抽样情形下，考虑利用逆变换法构造含其它三个参数的函数<code>mysample</code>。</p>
<p>我们考虑先取一个随机数种子，构造一个指定样本容量<span class="math inline">\(size1\)</span>的<span class="math inline">\(U(0,1)\)</span>均匀分布向量，并给出该离散分布的累计分布函数，并加上0方便下一步的比较。
我们再建立两层<code>for</code>循环语句，对于<span class="math inline">\(size1\)</span>个数，分别利用对应的均匀分布随机数与累计分布函数上的端点进行比较，并最终根据投入的区间位置确定输出的随机抽样取值，并将对应频率与概率进行对比。为了方便展示，之后输出的随机数数组都只展示前15个数。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>mysample<span class="ot">=</span><span class="cf">function</span>(n1,size1,probabilty1)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>{<span class="fu">set.seed</span>(<span class="dv">2000</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  sample1<span class="ot">=</span><span class="fu">runif</span>(size1)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  sdf1<span class="ot">=</span><span class="fu">cumsum</span>(probabilty1)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  sdf2<span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,sdf1)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>   length1<span class="ot">=</span><span class="fu">length</span>(n1)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  output<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>length1, <span class="at">times=</span>length1)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>size1)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>{</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>length1)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  {</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>    <span class="cf">if</span>(sample1[k]<span class="sc">&lt;=</span>sdf2[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">&amp;&amp;</span>sample1[k]<span class="sc">&gt;</span>sdf2[i])</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>    {</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>      output[k]<span class="ot">=</span>n1[i]</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>    }</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>  }</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>} </span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  ct <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">table</span>(output))</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  <span class="fu">print</span>(ct<span class="sc">/</span><span class="fu">sum</span>(ct)<span class="sc">/</span>probabilty1)</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>}</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>result1<span class="ot">=</span><span class="fu">mysample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">60</span>,<span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">2</span>,.<span class="dv">3</span>,.<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 1.1666667 0.6666667 1.0555556 1.0555556</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">print</span>(result1[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>])</span></code></pre></div>
<pre><code>##  [1] 1 4 2 2 4 3 4 4 4 3 1 1 1 1 4</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>result2<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">60</span>,<span class="at">replace=</span>T,<span class="at">prob=</span><span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">2</span>,.<span class="dv">3</span>,.<span class="dv">3</span>))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">print</span>(result2[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>])</span></code></pre></div>
<pre><code>##  [1] 4 2 4 4 4 2 4 2 4 3 3 3 2 2 2</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>result1<span class="ot">=</span><span class="fu">mysample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="fl">1e5</span>,<span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">2</span>,.<span class="dv">3</span>,.<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 1.0143000 0.9957000 1.0030667 0.9902667</code></pre>
<p>可以看到，我们的<code>mysample</code>函数在同个随机数种子下输出的结果与<code>sample</code>是不同的，可能其用了不同的随机数
在样本量较小(60)时，<code>mysample</code>函数的输出结果随机抽样的频率与
概率还有较大差距，但样本量很大(<span class="math inline">\(10^5\)</span>)时基本频率趋近于概率。</p>
</div>
<div id="answer2" class="section level2">
<h2>Answer2</h2>
<p>对于<code>Laplace</code>分布，考虑其累计分布函数 <span class="math display">\[
F(x)=\begin{cases}
\frac{1}{2}e^x &amp;\text{x &lt; 0或x=0}\\
1-\frac{1}{2}e^{-x} &amp;\text{x&gt;0}
\end{cases}
\]</span>
所以正负两边累计分布函数不相等，我们求出对应的累计分布函数的反函数(分段函数)后，利用均匀分布<span class="math inline">\(Uniform(0,1)\)</span>逆变换得到所求的函数分布后，再将生成函数的密度函数与实际的概率密度进行比较。
<span class="math display">\[
F^{-1}(u)=\begin{cases}
\ln(2u) &amp;\text{u &lt; 1/2或u = 1/2}\\
-\ln(2-2u) &amp;\text{u&gt;1/2}
\end{cases}
\]</span></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="dv">0</span>,<span class="at">by=</span>n)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>sample2<span class="ot">=</span><span class="fu">runif</span>(n)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>{</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  <span class="cf">if</span>(sample2[i]<span class="sc">&lt;</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  {</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>    output[i]<span class="ot">=</span><span class="fu">log</span>(sample2[i]<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  }</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  <span class="cf">if</span>(sample2[i]<span class="sc">&gt;=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>  {</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>    output[i]<span class="ot">=</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">-</span>sample2[i]<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>  }</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>}</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="fu">print</span>(output[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>])</span></code></pre></div>
<pre><code>##  [1] -0.52346412 -1.96253568 -0.02299905 -0.02962667 -1.57242620  0.38666960
##  [7] -3.25053122  0.18128095  1.12702651 -2.23969451  0.65254011 -0.92852429
## [13]  0.44295055  0.36659828  0.21044826</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">hist</span>(output, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fl">0.5</span><span class="sc">*</span>e<span class="sc">^</span>({<span class="sc">-</span><span class="fu">abs</span>(x)})))</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, .<span class="dv">01</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>({<span class="sc">-</span><span class="fu">abs</span>(y)}))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可以看出确实生成的分布函数（样本容量1000）的概率密度函数与给定的<code>Laplace</code>函数基本一致。</p>
</div>
<div id="answer3" class="section level2">
<h2>Answer3</h2>
<p>本问题需要我们使用接受拒绝方法生成<span class="math inline">\(Beta(a,b)\)</span>分布。 我们可以先生成<span class="math inline">\(Uniform(0,1)\)</span>均匀分布(分布记为<span class="math inline">\(g(x)\)</span>)的随机变量，再利用<code>dbeta</code>
函数生成服从<span class="math inline">\(Bata\)</span>分布密度函数<span class="math inline">\(f(x)\)</span>的随机变量。这里我们选定c=2,
如若<span class="math inline">\(f(x)\geq
c*g(x)\)</span>则接受这样的<span class="math inline">\(x\)</span>，否则拒绝，由此
我们可得到样本容量为<span class="math inline">\(n\)</span>的服从<span class="math inline">\(Beta(a,b)\)</span>分布的随机变量序列。</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>mybeta<span class="ot">=</span><span class="cf">function</span>(a,b,n){</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>j<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>y <span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>u1 <span class="ot">=</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>j <span class="ot">=</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>) </span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">dbeta</span>(x,a,b)<span class="sc">/</span><span class="dv">2</span> <span class="sc">&gt;</span> u1) {</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>k <span class="ot">=</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>y[k]<span class="ot">=</span> x</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>}</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>}</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="fu">return</span>(y)</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>}</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10000</span>)</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>beta1<span class="ot">=</span><span class="fu">mybeta</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">10000</span>)</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="fu">hist</span>(beta1, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">-</span><span class="fu">Beta</span>(<span class="dv">3</span>,<span class="dv">2</span>)))</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, .<span class="dv">001</span>)</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="fu">dbeta</span>(y,<span class="dv">3</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>最终得到的所编写函数生成的满足<span class="math inline">\(Beta(2,3)\)</span>分布的随机变量序列的直方图如上图所示，可以看到其密度函数与理论上的密度函数是基本一致的。</p>
</div>
<div id="answer4" class="section level2">
<h2>Answer4</h2>
<p>我们考虑先编写能生成服从密度函数<span class="math inline">\(f_e\)</span>的随机变量的函数。由于该密度函数对应的累计分布函数的逆函数不易求显示解，我们在这里采用接受-拒绝法编写函数。
由于核函数分布在<span class="math inline">\([-1,1]\)</span>区间内，我们可以先生成<span class="math inline">\(Uniform(-1,1)\)</span>均匀分布(分布记为<span class="math inline">\(g(x)\)</span>)的随机变量，再利用密度函数<span class="math inline">\(f(x)\)</span>=<span class="math inline">\(f_e\)</span>生成对应的随机变量。这里我们选定c=3
，如若<span class="math inline">\(f(x)\geq
c*g(x)\)</span>则接受这样的<span class="math inline">\(x\)</span>，否则拒绝，由此我们可得到样本容量为<span class="math inline">\(n\)</span>的服从给定核函数分布的随机变量序列。</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>mykernel<span class="ot">=</span><span class="cf">function</span>(n){</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>y <span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>u1 <span class="ot">=</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) </span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="cf">if</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">&gt;</span> u1) {</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>k <span class="ot">=</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>y[k]<span class="ot">=</span> x</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>}</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>}</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="fu">return</span>(y)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>}</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">mykernel</span>(<span class="fl">1e5</span>)</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">fe</span>(x)))</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, .<span class="dv">0001</span>)</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="dv">3</span><span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span>) )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>最终在得到的大样本(<span class="math inline">\(n=10^5\)</span>)下核函数的直方图密度估计是与理论上的核函数分布基本一致，一定程度上检验了我们编写的随机数生成函数。</p>
</div>
<div id="answer5" class="section level2">
<h2>Answer5</h2>
<p>由于<span class="math inline">\(U_1, U_2, U_3\sim
Uniform(-1,1)\)</span> ,那么三个随机变量<span class="math inline">\(U_1,
U_2, U_3\)</span>的密度函数均为<span class="math inline">\(f(x)=\frac{1}{2}\)</span>,累计分布函数为<span class="math inline">\(F(x)=\frac{1}{2}x+\frac{1}{2}\)</span>。我们先根据算法的流程生成大样本(<span class="math inline">\(n=10^5\)</span>)的随机变量序列，并画出直方图得到一个相应的密度估计，并与理论的核函数密度进行比较。</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>algkernel<span class="ot">=</span><span class="cf">function</span>(n){</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>y <span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>x1 <span class="ot">=</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) </span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>x3<span class="ot">=</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">abs</span>(x3) <span class="sc">&gt;</span> <span class="fu">abs</span>(x2)<span class="sc">&amp;&amp;</span><span class="fu">abs</span>(x3)<span class="sc">&gt;</span><span class="fu">abs</span>(x1)) {</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>k <span class="ot">=</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>y[k]<span class="ot">=</span> x2</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>}</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>{k <span class="ot">=</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>y[k]<span class="ot">=</span> x3}</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>}</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="fu">return</span>(y)</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>}</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>l<span class="ot">=</span><span class="fu">algkernel</span>(<span class="fl">1e5</span>)</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="fu">hist</span>(l, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">fe</span>(x)))</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, .<span class="dv">0001</span>)</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="dv">3</span><span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span>) )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>我们也可以看出直方图密度估计是与理论上的核函数分布基本一致，一定程度上验证了该算法的有效性。
# Question</p>
</div>
<div id="question1-1" class="section level2">
<h2>Question1</h2>
<p>对于<em>Buffon</em>投针试验圆周率的参数估计结果，请证明<span class="math inline">\(\rho=\frac{l}{d}\)</span>能使得<span class="math inline">\(\hat{\pi}\)</span>的渐近方差达到最小(采用<span class="math inline">\(\delta\)</span>方法，<span class="math inline">\(m\sim B(n,p)\)</span>),记最优的<span class="math inline">\(\rho\)</span>为<span class="math inline">\(\rho_{min}\)</span>.</p>
</div>
<div id="question2-1" class="section level2">
<h2>Question2</h2>
<p>取三个不同的<span class="math inline">\(\rho\)</span>(<span class="math inline">\(0\leq\rho\leq 1\)</span>),其中一个为<span class="math inline">\(\rho_{min}\)</span></p>
<p>1.若<span class="math inline">\(\rho_{min}=1\)</span>，则取其它两个<span class="math inline">\(\rho\)</span>为0.5,0.8.</p>
<p>2.若<span class="math inline">\(\rho_{min}&lt;1\)</span>，则取其它两个<span class="math inline">\(\rho\)</span>为<span class="math inline">\(\frac{\rho_{min}}{2}\)</span>,1.</p>
<p>再用<span class="math inline">\(MontoCarlo\)</span>方法比较在三个<span class="math inline">\(\rho\)</span>之下<span class="math inline">\(\hat{\pi}\)</span>的方差大小(取<span class="math inline">\(n=10^6,\)</span>模拟重复的次数K=100)</p>
</div>
<div id="question3-1" class="section level2">
<h2>Question3</h2>
<p>对于例子5.6中描述的利用控制变量法进行处理的<span class="math inline">\(Monto Carlo\)</span>积分 <span class="math display">\[ \theta=\int_0^1 e^x dx
\]</span>我们现在考虑对偶变量方法，计算<span class="math inline">\(Cov(e^U,e^{1-U})\)</span>以及<span class="math inline">\(Var(e^U+e^{1-U})\)</span>, 其中<span class="math inline">\(U\sim
Uniform(0,1)\)</span>。那么利用对偶变量方法得到的估计量<span class="math inline">\(\hat{\theta}\)</span>的方差相比一般的<span class="math inline">\(MontoCarlo\)</span>方法来说降低了多少？</p>
</div>
<div id="question4-1" class="section level2">
<h2>Question4</h2>
<p>使用对偶变量方法与普通<span class="math inline">\(MontoCarlo\)</span>方法进行数值模拟估计<span class="math inline">\(\theta\)</span>。计算使用对偶变量方法减少方差的百分比的经验估计。将该结果与练习5.6中的理论值进行比较</p>
</div>
</div>
<div id="answer-1" class="section level1">
<h1>Answer</h1>
<div id="answer1-1" class="section level2">
<h2>Answer1</h2>
<p>我们对于该<em>Buffon</em>投针试验，考虑得到其<span class="math inline">\(Monto
Carlo\)</span>估计的方差具体表达形式。由于投针n次m次投中线上的这一事件发生的概率服从二项分布<span class="math inline">\(B(n,p)\)</span>,理论上投中的概率为 <span class="math inline">\(P\left(\frac{l}{2} \sin (Y) \geq X\right)=\frac{2
l}{d \pi}\)</span>,其中 <span class="math inline">\(Y \sim U(0, \pi /
2), X \sim U(0, d / 2)\)</span>。<span class="math inline">\(\hat{\pi}\)</span>估计量的取值为<span class="math display">\[\hat{\pi}=\frac{2l}{d *P\left(\frac{l}{2} \sin
(Y) \geq X\right)}\]</span></p>
<p>记事件A为单次投针结果投到线上。</p>
<p>那么<span class="math display">\[Var(\frac{m}{n})=\frac{p(A)(1-P(A))}{n}=\frac{\frac{2\rho}{\pi  }(1-\frac{2\rho}{\pi  })}{n}\]</span></p>
<p>实际上<span class="math inline">\(Monto
Carlo\)</span>模拟计算得到的<span class="math inline">\(\hat{P}\left(\frac{l}{2} \sin (Y) \geq
X\right)=\frac{m}{n}\)</span>。</p>
<p>那么根据<span class="math inline">\(\delta\)</span>方法有 <span class="math display">\[Var(\hat{\pi})=Var(\frac{m}{n})*(\frac{\pi^2}{2\rho})^2\]</span></p>
<p>代入<span class="math inline">\(var(\frac{m}{n})\)</span>并经过对该函数求导处理可得当<span class="math inline">\(\rho=1\)</span>的时候方差取到极小值，结合<span class="math inline">\(\rho\geq0\)</span>我们也能判断<span class="math inline">\(\rho=1\)</span>也是圆周率估计量渐近方差的最小值。</p>
</div>
<div id="answer2-1" class="section level2">
<h2>Answer2</h2>
<p>我们根据题意进行数的选取并比较它们的方差,由于先选三个[0,1]中的随机数构成初始的三个<span class="math inline">\(\rho\)</span>,再比较三个<span class="math inline">\(\rho\)</span>从而得到使得圆周率的渐近方差（<span class="math inline">\(n=1e5\)</span>）达到最小的数<span class="math inline">\(\rho_{min}\)</span>,选出最小数后将<span class="math inline">\(min\{1,2*\rho_{min}\},\rho_{min},\rho_{min}/2\)</span>作为三个新的<span class="math inline">\(\rho\)</span>继续比较。
如此循环K=100次得出最终三个<span class="math inline">\(\rho\)</span>结果。</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10000</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>pihat<span class="ot">=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="fl">1e-4</span>,<span class="at">to=</span><span class="dv">1</span>,<span class="at">by=</span><span class="fl">1e-4</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>data1<span class="ot">=</span><span class="fu">runif</span>(<span class="dv">3</span>)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>result<span class="ot">=</span><span class="fu">numeric</span>(<span class="at">length=</span><span class="dv">3</span>)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>{i</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>{l<span class="ot">=</span>data1[j]</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fl">1e4</span>)</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>{X <span class="ot">=</span><span class="fu">runif</span>(<span class="dv">100</span>,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>Y <span class="ot">=</span><span class="fu">runif</span>(<span class="dv">100</span>,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>  pihat[k]<span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)}</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>  result[j]<span class="ot">=</span><span class="fu">var</span>(pihat)</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>  m<span class="ot">=</span><span class="fu">which</span>(result<span class="sc">==</span><span class="fu">min</span>(result),<span class="at">arr.ind =</span>F)</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>min1<span class="ot">=</span>data1[m]</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>data1<span class="ot">=</span><span class="fu">c</span>(min1<span class="sc">*</span><span class="fl">0.5</span>,min1,<span class="fu">min</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>min1,<span class="dv">1</span>)))</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>}</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>}</span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="fu">print</span>(data1)</span></code></pre></div>
<pre><code>## [1] 0.5 1.0 1.0</code></pre>
<p>最终循环得到的三元组中使得渐近方差最小的<span class="math inline">\(\rho=1\)</span>,由此我们可以得到在<span class="math inline">\(\rho\in[0,1]\)</span>时，当<span class="math inline">\(\rho=1\)</span>时圆周率的渐近方差（<span class="math inline">\(n=1e5\)</span>）可以达到最小<span class="math inline">\(\rho_{min}\)</span>。 ## Answer3</p>
<p>本问题需要我们先计算<span class="math inline">\(Cov(e^U,e^{1-U})\)</span>以及<span class="math inline">\(Var(e^U+e^{1-U})\)</span>, 其中<span class="math inline">\(U\sim Uniform(0,1)\)</span>，随机变量<span class="math inline">\(U\)</span>的累积分布函数为<span class="math inline">\(F(x)=x\)</span>,那么根据随机变量的变换，随机变量<span class="math inline">\(e^U\)</span>的累积分布函数为<span class="math inline">\(F(u_1)=ln(u_1)\)</span>,随机变量<span class="math inline">\(e^{1-U}\)</span>的累积分布函数为<span class="math inline">\(F(u_2)=ln(u_2)\)</span>，那么可以计算得</p>
<p><span class="math display">\[
\begin{aligned}
Cov(e^U,e^{1-U})&amp;=E(e^U*e^{1-U})-E(e^U)E(e^{1-U})=e-(e-1)^2=-e^2+3e-1=-0.23&lt;0\\
Var(e^U+e^{1-U})&amp;=Var(e^u)+Var(e^{1-u})+2Cov(e^u,e^{1-u})=-3e^2+10e-5=0.016
\end{aligned}
\]</span> 那么随机变量的<span class="math inline">\(e^U\)</span>与<span class="math inline">\(e^{1-U}\)</span>的协方差小于0，两者和的方差小于方差之和，那么在理论上利用对偶方法确实能够有效降低<span class="math inline">\(MontoCarlo\)</span>模拟得到的估计量方差。且理论上对偶方法降低方差的百分比<span class="math inline">\(A\)</span>为 <span class="math display">\[
A=\frac{{Var(e^u)}-Var(\frac{e^U+e^{1-U}}{2})}{{Var(e^u)}}*100\%=98.4\%
\]</span></p>
<p>最终得到的对偶方法生成的估计量降低方差的百分比<span class="math inline">\(A\)</span>为98.4%</p>
</div>
<div id="answer4-1" class="section level2">
<h2>Answer4</h2>
<p>我们考虑利用一般<span class="math inline">\(MontoCarlo\)</span>估计与对偶方法的<span class="math inline">\(MontoCarlo\)</span>估计在大样本下分别对参数<span class="math inline">\(\theta\)</span>进行估计得到两个估计量<span class="math inline">\(\hat{\theta}\)</span>的经验方差，从而进行一定的比较。</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2000</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>num<span class="ot">=</span><span class="fl">1e5</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>n1<span class="ot">=</span><span class="fu">runif</span>(num)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>result1<span class="ot">=</span><span class="fu">exp</span>(n1)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>mean1<span class="ot">=</span><span class="fu">mean</span>(result1)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>var1<span class="ot">=</span><span class="fu">var</span>(result1)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(mean1,var1))</span></code></pre></div>
<pre><code>## [1] 1.7151319 0.2415935</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>n2<span class="ot">=</span><span class="fu">runif</span>(num<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>result2<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(n2)<span class="sc">+</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>({<span class="dv">1</span><span class="sc">-</span>n2}))</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>mean2<span class="ot">=</span><span class="fu">mean</span>(result2)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>var2<span class="ot">=</span><span class="fu">var</span>(result2)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(mean2,var2))</span></code></pre></div>
<pre><code>## [1] 1.718497346 0.003909478</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>stand<span class="ot">=</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>A<span class="ot">=</span>(var1<span class="sc">-</span>var2)<span class="sc">/</span>var1</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">print</span>(A)</span></code></pre></div>
<pre><code>## [1] 0.983818</code></pre>
<p>最终在得到的大样本(<span class="math inline">\(n=10^5\)</span>)下对偶方法生成的估计量<span class="math inline">\(\hat{\theta}\)</span>均值与一般方法生成估计量的均值相当接近，而对偶方法相当一般<span class="math inline">\(MontoCarlo\)</span>估计方法降低方差的百分比<span class="math inline">\(A\)</span>为98.4%,与理论结果比较接近。 #
Question</p>
</div>
<div id="question1-2" class="section level2">
<h2>Question1</h2>
<p><span class="math inline">\(\operatorname{Var}\left(\hat{\theta}^M\right)=\frac{1}{M
k} \sum_{i=1}^k
\sigma_i^2+\operatorname{Var}\left(\theta_I\right)=\operatorname{Var}\left(\hat{\theta}^S\right)+\operatorname{Var}\left(\theta_I\right)\)</span>,
此时 <span class="math inline">\(\theta_i=E[g(U) \mid I=i],
\sigma_i^2=\operatorname{Var}[g(U) \mid I=i]\)</span> 且 <span class="math inline">\(I\)</span> 服从集合 <span class="math inline">\(\{1, \ldots, k\}\)</span>上的均匀分布.</p>
<p>证明如果<span class="math inline">\(g\)</span> 是一个区间 <span class="math inline">\((a, b)\)</span>上的连续函数, 那么 <span class="math inline">\(\operatorname{Var}\left(\hat{\theta}^S\right) /
\operatorname{Var}\left(\hat{\theta}^M\right) \rightarrow 0\)</span> 当
<span class="math inline">\(b_i-a_i \rightarrow 0\)</span> 对所有的
<span class="math inline">\(i=1, \ldots, k\)</span>都成立.</p>
</div>
<div id="question2-2" class="section level2">
<h2>Question2</h2>
<p>请找到定义在<span class="math inline">\((1,
\infty)\)</span>两个重要性函数 <span class="math inline">\(f_1\)</span>
以及 <span class="math inline">\(f_2\)</span> 而且与<span class="math inline">\(g(x)\)</span> 比较接近。 <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2}, \quad x&gt;1 .
\]</span>
这两个重要性函数中哪一个在通过重要性采样方法进行MC估计的时候具有较小的方差?
<span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2} d x
\]</span> 解释你做出判断的原因.</p>
</div>
<div id="question3-2" class="section level2">
<h2>Question3</h2>
<p>通过重要性采样的方法得到以下函数的MC估计结果。 <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2} d x
\]</span></p>
</div>
<div id="question4-2" class="section level2">
<h2>Question4</h2>
<p>利用分层重要性采样方法得到 例子 5.13中的估计结果
且将其与例子5.10的结果进行对比.</p>
</div>
<div id="question5-1" class="section level2">
<h2>Question5</h2>
<p>假定我们用 95%的对称 t
区间在样本数据是非正态的情况下来估计平均数。那么置信区间覆盖均值的概率不一定等于
0.95.现在使用MC方法估算样本容量为 <span class="math inline">\(n =
20\)</span> 的服从<span class="math inline">\(\chi^2(2)\)</span>分布的随机样本的t区间覆盖概率与例子6.4中的结果进行对比。</p>
</div>
<div id="question6" class="section level2">
<h2>Question6</h2>
<p>使用MC模拟来研究在抽样总体不服从非正态分布的情况下，t
检验的经验第一类错误率是否近似等于名义显著性水平<span class="math inline">\(\alpha\)</span>。t
检验在轻微偏离正态性的情形下是稳健的。讨论采样总体 (i) <span class="math inline">\(\chi^2(1)\)</span>、(ii) <span class="math inline">\(Uniform(0,2)\)</span> 和 (iii) <span class="math inline">\(Exponential\)</span>(rate=1)
时的模拟结果。在每种情况下，分别检验 <span class="math inline">\(H_0 : µ
= µ_0\)</span> 与 <span class="math inline">\(H0 : µ \neq
µ_0\)</span>，其中 <span class="math inline">\(µ_0\)</span> 是 <span class="math inline">\(\chi^2(1)、Uniform(0,2)\)</span>和 <span class="math inline">\(Exponential(1)\)</span>的均值。</p>
</div>
</div>
<div id="answer-2" class="section level1">
<h1>Answer</h1>
<div id="answer1-2" class="section level2">
<h2>Answer1</h2>
<p>相当于证<span class="math inline">\(\frac{\operatorname{Var}\left(\hat{\theta}^S\right)}{\frac{1}{M}\operatorname{Var}\left(\theta_I\right)}=\frac{\frac{1}{K}\sum_1^k\sigma_i^2}{\operatorname{Var}\left(\theta_I\right)}\rightarrow
0\)</span> 当<span class="math inline">\(b_i-a_i\rightarrow
0\)</span>时，我们可以得到<span class="math inline">\(k\rightarrow\infty\)</span>。 而 <span class="math display">\[
\begin{aligned}
E(\theta_i)=&amp;E(g(U)),E^2(\theta_i)=E^2(E(g(U))=(Eg(U))^2\\
\operatorname{Var}(\theta_I)=&amp;E(\theta_i^2)-E^2(\theta_i)=\\
-E(Var(g(U|I=i)))+&amp;E(E(g^2(U)|I=i))-(Eg(U))=Var(g(U))-\frac{1}{k}\sum_{i=1}^k\sigma_i^2\end{aligned}
\]</span> 而由g连续,<span class="math inline">\({Var(g(U))}\geq\sum_{i=1}^k\sigma_i^2=\sum_{i=1}^kVar(g(U)|I=i)\)</span>,有<span class="math inline">\(\frac{Var(\theta_I)}{\operatorname{Var}\left(\hat{\theta}^S\right)}\rightarrow\infty\)</span>当<span class="math inline">\(k\rightarrow \infty\)</span>时，原命题得证。</p>
</div>
<div id="answer2-2" class="section level2">
<h2>Answer2</h2>
<p>我们考虑以下两个重要性函数 <span class="math inline">\(f_1\)</span>
以及 <span class="math inline">\(f_2\)</span> <span class="math display">\[
f_1=\frac{1}{\sqrt{2\pi}}e^{\frac{-x^2}{2}}*\frac{1}{1-\Phi(1)},f_2=e^{-(x-1)}
\]</span></p>
<p>其中<span class="math inline">\(\Phi(x)\)</span>为标准正态分布函数对应的累计分布函数CDF。即<span class="math inline">\(f_1\)</span>为 在区间<span class="math inline">\((1,\infty)\)</span>中截取的正态分布密度函数，<span class="math inline">\(f_2\)</span>为参数<span class="math inline">\(\lambda=1\)</span>对应的指数分布密度函数的自变量向右平移一单位得到的密度函数。那么<span class="math inline">\(\frac{f}{f_i},i=1,2\)</span>可以表示为以下形式
<span class="math display">\[
\frac{g}{f_1}=x^2*{1-\Phi(1)},\frac{g}{f_2}=\frac{1}{\sqrt{2\pi}}x^2e^{\frac{-x^2}{2}+(x-1)}
\]</span></p>
<p>之后我们可以计算出我们以下通过模拟的方法计算在两个重要性函数对应的两种重要性采样中MC估计的方差结果。我们先通过函数得到服从正态分布与指数分布的随机数，再利用直方图对生成的随机样本服从指定分布这一事实进行验证，最后利用期望的计算方法依次得到积分的估计量与估计量方差结果。</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2000</span>)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">5</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>sample1<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>{</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  sample1[i]<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  <span class="cf">while</span>(sample1[i]<span class="sc">&lt;=</span><span class="dv">1</span>)</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>  {</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>    sample1[i]<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>  }</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>}</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>sample2<span class="ot">=</span><span class="fu">rexp</span>(m,<span class="at">rate=</span><span class="dv">1</span>)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co">#两个函数的形式</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="fu">hist</span>(sample1,<span class="at">prob=</span>T)</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, .<span class="dv">001</span>)</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="fu">dnorm</span>(y)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">1</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">hist</span>(sample2,<span class="at">prob=</span>T)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, .<span class="dv">001</span>)<span class="co">#验证分布服从指定分布的结果</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="fu">dexp</span>(y,<span class="at">rate=</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>result1<span class="ot">&lt;-</span>result2<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>{result1[i]<span class="ot">=</span>sample1[i]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">1</span>))</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>result2[i]<span class="ot">=</span>sample2[i]<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>sample2[i]<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>sample2[i]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>}</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(result1),<span class="fu">mean</span>(result2)))</span></code></pre></div>
<pre><code>## [1] 0.3998574 0.4005739</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">var</span>(result1),<span class="fu">var</span>(result2)))</span></code></pre></div>
<pre><code>## [1] 0.06873614 0.02484218</code></pre>
<p>在大样本(<span class="math inline">\(m=10^5\)</span>)下，我们得到输出的估计量均值与方差，其中第一种是截断的正态分布，第二种为平移的指数分布，我们可以看出两种重要性函数得到的估计量取值均为0.400左右，但平移的指数分布作为重要性函数得到的估计量的方差明显小于第一种截断的正态分布分布。</p>
</div>
<div id="answer3-1" class="section level2">
<h2>Answer3</h2>
<p>根据Answer2结果我们可以得到所求积分的MC估计量为0.400</p>
</div>
<div id="answer4-2" class="section level2">
<h2>Answer4</h2>
<p>在该例子5.13中，原题中给出概率密度函数有点问题，其在每个子区间<span class="math inline">\((\frac{j-1}{5},\frac{j}{5}]\)</span>的积分都不等于1，为了使得该题目能够正常解决，我们对于密度函数的系数进行一些改变，新的子区间上的概率密度函数为
<span class="math display">\[
P(x)=\frac{e^{-x}}{\int_{\frac{j-1}{5}}^{\frac{j}{5}}e^{-x}}
=\frac{e^{-x}}{(e^{-\frac{j-1}{5}}-e^{-\frac{j}{5}})}\quad
x\in(\frac{j-1}{5},\frac{j}{5}]
\]</span>
那么我们以下根据该密度函数进行密度函数的重要性函数的分层抽样，在分层的情况中我们考虑在每个子区间中抽样频率相同的情形。具体步骤我们先利用逆变换法生成随机数，代入利用重要性采样方法计算出每一个小区间的积分，再进行加总求和。</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">50</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>sample1<span class="ot">=</span>sample2<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>est1<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>N,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>est2<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>N,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>T<span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>{g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> (x <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>}</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>  sample1<span class="ot">=</span><span class="fu">runif</span>(m)<span class="co">#逆变换法</span></span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>x <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> sample1<span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>est1[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a><span class="co">#Example6.10结果</span></span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a></span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a>  {g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> (x <span class="sc">&gt;</span>(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>) <span class="sc">*</span> (x <span class="sc">&lt;</span> ((j)<span class="sc">/</span><span class="dv">5</span>))</span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a>}</span>
<span id="cb29-25"><a href="#cb29-25" tabindex="-1"></a>  sample2<span class="ot">=</span><span class="fu">runif</span>(m<span class="sc">/</span>n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb29-26"><a href="#cb29-26" tabindex="-1"></a>  x<span class="ot">=</span><span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span>sample2 <span class="sc">*</span> (<span class="fu">exp</span>(<span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>(j)<span class="sc">/</span><span class="dv">5</span>)))</span>
<span id="cb29-27"><a href="#cb29-27" tabindex="-1"></a>fg1 <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>(j)<span class="sc">/</span><span class="dv">5</span>)))</span>
<span id="cb29-28"><a href="#cb29-28" tabindex="-1"></a>T[j]<span class="ot">=</span><span class="fu">mean</span>(fg1)</span>
<span id="cb29-29"><a href="#cb29-29" tabindex="-1"></a><span class="co">#新方法分层抽样</span></span>
<span id="cb29-30"><a href="#cb29-30" tabindex="-1"></a>}</span>
<span id="cb29-31"><a href="#cb29-31" tabindex="-1"></a>est1[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(T)</span>
<span id="cb29-32"><a href="#cb29-32" tabindex="-1"></a><span class="co">#分层重要性抽样结果</span></span>
<span id="cb29-33"><a href="#cb29-33" tabindex="-1"></a>}</span>
<span id="cb29-34"><a href="#cb29-34" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">apply</span>(est1,<span class="dv">2</span>,mean),<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## [1] 0.5247 0.5248</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">apply</span>(est1,<span class="dv">2</span>,sd),<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## [1] 8e-04 2e-04</code></pre>
<p>我们通过新方法也就是在每个小区间使用分层重要性抽样得到的结果进行MC估计的估计量的结果与一般重要性采样方法大致接近，均为0.525，但标准差结果明显比一般方法好。</p>
</div>
<div id="answer5-1" class="section level2">
<h2>Answer5</h2>
<p>我们可以利用t分布的相关分位数性质得到生成的t区间,对于服从<span class="math inline">\(\chi^2(2)\)</span>分布的随机变量<span class="math inline">\(X\)</span>，其均值为2，方差为2n,所以我们可以如下构建t统计量,我们用样本标准差<span class="math inline">\(S^2\)</span>代替总体标准差 <span class="math display">\[
t=\frac{\overline{X}-2}{\sqrt{\frac{1}{n}s^2}}\sim t(n-1)
\]</span> 那么可以得到均值置信区间<span class="math inline">\([2-t_{\frac{\alpha}{2}}\frac{s}{\sqrt{n}},2+t_{\frac{\alpha}{2}}\frac{s}{\sqrt{n}}]\)</span>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">200</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">5</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>num1<span class="ot">=</span>num2<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">2</span>)</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>samplesd<span class="ot">=</span><span class="fu">sd</span>(x)</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>meanx<span class="ot">=</span><span class="fu">mean</span>(x)</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>leftpoint<span class="ot">=</span><span class="dv">2</span><span class="sc">-</span>(<span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span><span class="dv">19</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">20</span>))</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>rightpoint<span class="ot">=</span><span class="dv">2</span><span class="sc">+</span>(<span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span><span class="dv">19</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">20</span>))<span class="co">#t分布</span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>leftpoint1<span class="ot">=</span><span class="dv">2</span><span class="sc">-</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">20</span>))</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>rightpoint1<span class="ot">=</span><span class="dv">2</span><span class="sc">+</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">20</span>))<span class="co">#正态</span></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a><span class="cf">if</span>(leftpoint<span class="sc">&lt;</span>meanx <span class="sc">&amp;&amp;</span> meanx<span class="sc">&lt;</span>rightpoint)</span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a>{</span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>  num1<span class="ot">=</span>num1<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>}</span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a><span class="cf">if</span>(leftpoint1<span class="sc">&lt;</span>meanx <span class="sc">&amp;&amp;</span> meanx<span class="sc">&lt;</span>rightpoint1)</span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a>{</span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a>  num2<span class="ot">=</span>num2<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a>}</span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a></span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a>}</span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a>result1<span class="ot">=</span>num1<span class="sc">/</span>m</span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a>result2<span class="ot">=</span>num2<span class="sc">/</span>m</span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(result1,result2))</span></code></pre></div>
<pre><code>## [1] 0.91805 0.95160</code></pre>
<p>得到的t区间覆盖率为0.919显著低于0.95，说明此时CI是比较自由的。而
此时正态区间的覆盖率比较接近0.95。</p>
</div>
<div id="answer6" class="section level2">
<h2>Answer6</h2>
<p>我们分别在总体为<span class="math inline">\(\chi^2(1)\)</span>、
<span class="math inline">\(Uniform(0,2)\)</span> 和 <span class="math inline">\(Exponential\)</span>(rate=1)时计算三种分布下的第一类经验理论值结果。同样根据t分布性质检验统计量<span class="math display">\[
t=\frac{\overline{X}-\mu}{\sqrt{\frac{1}{n}s^2}}\sim t(n-1)
\]</span> 那么可以得到拒绝域<span class="math inline">\([-\infty，\mu-t_{\frac{\alpha}{2}}\frac{s}{\sqrt{n}}]\bigcup[\mu+t_{\frac{\alpha}{2}}\frac{s}{\sqrt{n}},\infty]\)</span>.此时假定<span class="math inline">\(\alpha=0.05\)</span></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">200</span>)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">5</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>num1<span class="ot">=</span>num2<span class="ot">=</span>num3<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">rexp</span>(n,<span class="at">rate=</span><span class="dv">1</span>)</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>meanx<span class="ot">=</span><span class="fu">mean</span>(x)</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>meany<span class="ot">=</span><span class="fu">mean</span>(y)</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>meanz<span class="ot">=</span><span class="fu">mean</span>(z)</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>leftpoint<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>(<span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>rightpoint<span class="ot">=</span><span class="dv">1</span><span class="sc">+</span>(<span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n))<span class="co">#t分布</span></span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a>leftpoint1<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>(<span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(y)<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a>rightpoint1<span class="ot">=</span><span class="dv">1</span><span class="sc">+</span>(<span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(y)<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>leftpoint2<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>(<span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(z)<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a>rightpoint2<span class="ot">=</span><span class="dv">1</span><span class="sc">+</span>(<span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(z)<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a><span class="cf">if</span>(leftpoint<span class="sc">&gt;</span>meanx <span class="sc">||</span>meanx<span class="sc">&gt;</span>rightpoint)</span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a>{</span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a>  num1<span class="ot">=</span>num1<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a>}</span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a><span class="cf">if</span>(leftpoint1<span class="sc">&gt;</span>meany <span class="sc">||</span> meany<span class="sc">&gt;</span>rightpoint1)</span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a>{</span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a>  num2<span class="ot">=</span>num2<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a>}</span>
<span id="cb35-26"><a href="#cb35-26" tabindex="-1"></a><span class="cf">if</span>(leftpoint2<span class="sc">&gt;</span>meanz <span class="sc">||</span> meanz<span class="sc">&gt;</span>rightpoint2)</span>
<span id="cb35-27"><a href="#cb35-27" tabindex="-1"></a>{</span>
<span id="cb35-28"><a href="#cb35-28" tabindex="-1"></a>  num3<span class="ot">=</span>num3<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb35-29"><a href="#cb35-29" tabindex="-1"></a>}</span>
<span id="cb35-30"><a href="#cb35-30" tabindex="-1"></a></span>
<span id="cb35-31"><a href="#cb35-31" tabindex="-1"></a>}</span>
<span id="cb35-32"><a href="#cb35-32" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(num1<span class="sc">/</span>m,num2<span class="sc">/</span>m,num3<span class="sc">/</span>m))</span></code></pre></div>
<pre><code>## [1] 0.06484 0.05040 0.05751</code></pre>
<p>可以得到在大样本(<span class="math inline">\(m=10^6\)</span>)的情形下,三种总体下t检验得到的经验第一类错误的频率分别为0.0648,0.0504,0.0575，都与显著性水平<span class="math inline">\(\alpha=0.05\)</span>比较接近。 # Question</p>
</div>
<div id="question1-3" class="section level2">
<h2>Question1</h2>
<p>考虑<span class="math inline">\(m=1000\)</span>个假设，其中前95%个原假设成立，后5%个对立假设成立。在原假设下
p值服从<span class="math inline">\(U(0,1)\)</span>分布，在对立假设下，p值服从<span class="math inline">\(Beta(0.1,1)\)</span>分布(可用<code>rbeta</code>生成)
应用<span class="math inline">\(Bonferroni\)</span>校正以及B-H校正应用于生成的m个独立p值(应用调整p值)，得到校正后的p值，
与<span class="math inline">\(\alpha\)</span>=0.1比较判断其是否拒绝原假设。基于1000次模拟可估计FWER,FDR，TPR(True
positive rate)并输出到表格里。</p>
</div>
<div id="question2-3" class="section level2">
<h2>Question2</h2>
<p>假定数量服从以<span class="math inline">\(\lambda\)</span>为参数的指数分布, 那么参数 <span class="math inline">\(\lambda\)</span> 的MLE估计量为 <span class="math inline">\(\hat{\lambda}=1 / \bar{X}\)</span>, 这里 <span class="math inline">\(\bar{X}\)</span> 为样本均值. 我们可以得出估计量
<span class="math inline">\(\hat{\lambda}\)</span>的期望为 <span class="math inline">\(\lambda n /(n-1)\)</span>,所以其期望的偏差为<span class="math inline">\(\lambda /(n-1)\)</span>. 而估计量 <span class="math inline">\(\hat{\lambda}\)</span>的 标准差是 <span class="math inline">\(\lambda n /[(n-1) \sqrt{n-2}]\)</span>.
完成以下的模拟研究 来展示 bootstrap 方法的效果.</p>
<p>请求得例 7.2 中相关统计量的 bootstrap 方法t 置信区间估计值 (law data
in bootstrap)</p>
</div>
</div>
<div id="answer-3" class="section level1">
<h1>Answer</h1>
<div id="answer1-3" class="section level2">
<h2>Answer1</h2>
<p>我们先取<span class="math inline">\(m=1000\)</span>个样本构成的数据集，其中<span class="math inline">\(950\)</span>个样本服从<span class="math inline">\(U(0,1)\)</span>，<span class="math inline">\(50\)</span>个样本服从给定的 <span class="math inline">\(Beta\)</span>分布。我们分别利用<span class="math inline">\(Bonferroni\)</span>方法与<span class="math inline">\(BH\)</span>方法输出调整后的p值结果。</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.1</span></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>num1<span class="ot">=</span>num2<span class="ot">=</span>num3<span class="ot">=</span>num4<span class="ot">=</span><span class="fu">numeric</span>(N)</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>{</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>sample1<span class="ot">=</span><span class="fu">runif</span>(<span class="dv">950</span>)</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>sample2<span class="ot">=</span><span class="fu">rbeta</span>(<span class="dv">50</span>,<span class="at">shape1=</span><span class="fl">0.1</span>,<span class="at">shape2=</span><span class="dv">1</span>)</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>position1<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="at">times=</span><span class="dv">950</span>)</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>position2<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="at">times=</span><span class="dv">50</span>)</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a>position<span class="ot">=</span><span class="fu">c</span>(position1,position2)<span class="co">#位置保留原假设与备择假设的分组信息</span></span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>sample0<span class="ot">=</span><span class="fu">c</span>(sample1,sample2)</span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>sampleall<span class="ot">=</span>(<span class="fu">cbind</span>(sample0,position))<span class="co">#样本生成</span></span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a>bonferroni1<span class="ot">=</span>BH1<span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a>sample0<span class="ot">=</span><span class="fu">sort</span>(sample0)</span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a>sampleall<span class="ot">=</span>sampleall[<span class="fu">order</span>(sampleall[,<span class="dv">1</span>]),]<span class="co">#样本与位置信息一起排序</span></span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb37-19"><a href="#cb37-19" tabindex="-1"></a>{bonferroni1[i]<span class="ot">=</span>n<span class="sc">*</span>sample0[i]<span class="co">#bonferroni方法修正</span></span>
<span id="cb37-20"><a href="#cb37-20" tabindex="-1"></a>  <span class="cf">if</span>( bonferroni1[i]<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb37-21"><a href="#cb37-21" tabindex="-1"></a>  {</span>
<span id="cb37-22"><a href="#cb37-22" tabindex="-1"></a>    bonferroni1[i]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb37-23"><a href="#cb37-23" tabindex="-1"></a>  }</span>
<span id="cb37-24"><a href="#cb37-24" tabindex="-1"></a>}</span>
<span id="cb37-25"><a href="#cb37-25" tabindex="-1"></a>BH1<span class="ot">=</span>sample0<span class="sc">*</span>n<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>n)<span class="co">#BH方法修正</span></span>
<span id="cb37-26"><a href="#cb37-26" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>))</span>
<span id="cb37-27"><a href="#cb37-27" tabindex="-1"></a>{</span>
<span id="cb37-28"><a href="#cb37-28" tabindex="-1"></a>  <span class="cf">if</span>( BH1[i]<span class="sc">&gt;</span>BH1[i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb37-29"><a href="#cb37-29" tabindex="-1"></a>  {</span>
<span id="cb37-30"><a href="#cb37-30" tabindex="-1"></a>    BH1[i]<span class="ot">=</span>BH1[i<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb37-31"><a href="#cb37-31" tabindex="-1"></a>  }</span>
<span id="cb37-32"><a href="#cb37-32" tabindex="-1"></a> <span class="cf">if</span>( BH1[i]<span class="sc">&lt;</span><span class="fl">0.1</span><span class="sc">&amp;&amp;</span>BH1[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">&gt;</span><span class="fl">0.1</span>)</span>
<span id="cb37-33"><a href="#cb37-33" tabindex="-1"></a>  {</span>
<span id="cb37-34"><a href="#cb37-34" tabindex="-1"></a>    num2[k]<span class="ot">=</span>i</span>
<span id="cb37-35"><a href="#cb37-35" tabindex="-1"></a>    num4[k]<span class="ot">=</span><span class="fu">sum</span>(sampleall[<span class="dv">1</span><span class="sc">:</span>i,<span class="dv">2</span>])<span class="co">#BH方法拒绝域中备择假设个数</span></span>
<span id="cb37-36"><a href="#cb37-36" tabindex="-1"></a> }</span>
<span id="cb37-37"><a href="#cb37-37" tabindex="-1"></a>   <span class="cf">if</span>( bonferroni1[i]<span class="sc">&lt;</span><span class="fl">0.1</span><span class="sc">&amp;&amp;</span>bonferroni1[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">&gt;</span><span class="fl">0.1</span>)</span>
<span id="cb37-38"><a href="#cb37-38" tabindex="-1"></a>  {</span>
<span id="cb37-39"><a href="#cb37-39" tabindex="-1"></a>    num1[k]<span class="ot">=</span>i<span class="co">#所有落入拒绝域的个数</span></span>
<span id="cb37-40"><a href="#cb37-40" tabindex="-1"></a>    num3[k]<span class="ot">=</span><span class="fu">sum</span>(sampleall[<span class="dv">1</span><span class="sc">:</span>i,<span class="dv">2</span>])<span class="co">#bonferroni方法拒绝域中备择假设个数</span></span>
<span id="cb37-41"><a href="#cb37-41" tabindex="-1"></a>  }</span>
<span id="cb37-42"><a href="#cb37-42" tabindex="-1"></a>}</span>
<span id="cb37-43"><a href="#cb37-43" tabindex="-1"></a></span>
<span id="cb37-44"><a href="#cb37-44" tabindex="-1"></a>}</span>
<span id="cb37-45"><a href="#cb37-45" tabindex="-1"></a>size1<span class="ot">=</span>size2<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb37-46"><a href="#cb37-46" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb37-47"><a href="#cb37-47" tabindex="-1"></a>{</span>
<span id="cb37-48"><a href="#cb37-48" tabindex="-1"></a>  <span class="cf">if</span>(num3[j]<span class="sc">/</span>num1[j]<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb37-49"><a href="#cb37-49" tabindex="-1"></a>  {size1<span class="ot">=</span>size1<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb37-50"><a href="#cb37-50" tabindex="-1"></a>   <span class="cf">if</span>(num4[j]<span class="sc">/</span>num2[j]<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb37-51"><a href="#cb37-51" tabindex="-1"></a>  {size2<span class="ot">=</span>size2<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb37-52"><a href="#cb37-52" tabindex="-1"></a>}</span>
<span id="cb37-53"><a href="#cb37-53" tabindex="-1"></a>mean1<span class="ot">=</span>size1<span class="sc">/</span>N</span>
<span id="cb37-54"><a href="#cb37-54" tabindex="-1"></a>mean2<span class="ot">=</span>size2<span class="sc">/</span>N</span>
<span id="cb37-55"><a href="#cb37-55" tabindex="-1"></a>mean3<span class="ot">=</span><span class="fu">mean</span>(<span class="dv">1</span><span class="sc">-</span>num3<span class="sc">/</span>num1)</span>
<span id="cb37-56"><a href="#cb37-56" tabindex="-1"></a>mean4<span class="ot">=</span><span class="fu">mean</span>(<span class="dv">1</span><span class="sc">-</span>num4<span class="sc">/</span>num2)</span>
<span id="cb37-57"><a href="#cb37-57" tabindex="-1"></a>mean5<span class="ot">=</span><span class="fu">mean</span>(num3<span class="sc">/</span><span class="dv">50</span>)</span>
<span id="cb37-58"><a href="#cb37-58" tabindex="-1"></a>mean6<span class="ot">=</span><span class="fu">mean</span>(num4<span class="sc">/</span><span class="dv">50</span>)</span>
<span id="cb37-59"><a href="#cb37-59" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(mean1,mean2,mean3,mean4,mean5,mean6))<span class="co">#输出三个指标在两种方法下的估计值</span></span></code></pre></div>
<pre><code>## [1] 0.100000000 0.928000000 0.005119384 0.094062900 0.399220000 0.562020000</code></pre>
<p>我们这里设定显著性水平为10%是比较合理的。我们进行<span class="math inline">\(M\)</span>=1000次实验后分别得出落入拒绝域的原假设与备择假设下个数，通过求均值得到三个指标的估计值。
根据<span class="math inline">\(Bonferroni,BH\)</span>两种方法得到的三个统计指标估计值如下表所示。</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>FWER</th>
<th>FDR</th>
<th>TPR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(Bonferroni\)</span></td>
<td>0.1</td>
<td>0.00512</td>
<td>0.399</td>
</tr>
<tr class="even">
<td><span class="math inline">\(BH\)</span></td>
<td>0.928</td>
<td>0.094</td>
<td>0.562</td>
</tr>
</tbody>
</table>
</div>
<div id="answer2-3" class="section level2">
<h2>Answer2</h2>
<p>我们先根据题意分别生成样本容量为<span class="math inline">\(n=5,10,21\)</span>的指数分布样本，并进行依次的<span class="math inline">\(Bootstrap\)</span>估计，在
1000次重复次数下得到偏差与标准误差的估计值。</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2000</span>)</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>length1<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>length2<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>length3<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>m<span class="ot">=</span>B<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>lambda<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>result1<span class="ot">=</span>result2<span class="ot">=</span>result3<span class="ot">=</span><span class="fu">numeric</span>(B)</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>mean1<span class="ot">=</span>mean2<span class="ot">=</span>mean3<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>sd1<span class="ot">=</span>sd2<span class="ot">=</span>sd3<span class="ot">=</span><span class="fu">numeric</span>(m)<span class="co">#三种样本容量的数据</span></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>{sample1<span class="ot">=</span><span class="fu">rexp</span>(length1,<span class="at">rate=</span>lambda)</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>  sample2<span class="ot">=</span><span class="fu">rexp</span>(length2,<span class="at">rate=</span>lambda)</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>  sample3<span class="ot">=</span><span class="fu">rexp</span>(length3,<span class="at">rate=</span>lambda)</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(B))</span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a>{ </span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>  sample1star<span class="ot">=</span><span class="fu">sample</span>(sample1,length1,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>  result1[i]<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(sample1star)</span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a> sample2star<span class="ot">=</span><span class="fu">sample</span>(sample2,length2,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a>   result2[i]<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(sample2star)</span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a> sample3star<span class="ot">=</span><span class="fu">sample</span>(sample3,length3,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a>   result3[i]<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(sample3star)</span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a>}</span>
<span id="cb39-23"><a href="#cb39-23" tabindex="-1"></a>mean1[k]<span class="ot">=</span><span class="fu">mean</span>(result1)<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(sample1)</span>
<span id="cb39-24"><a href="#cb39-24" tabindex="-1"></a>mean2[k]<span class="ot">=</span><span class="fu">mean</span>(result2)<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(sample2)</span>
<span id="cb39-25"><a href="#cb39-25" tabindex="-1"></a>mean3[k]<span class="ot">=</span><span class="fu">mean</span>(result3)<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(sample3)</span>
<span id="cb39-26"><a href="#cb39-26" tabindex="-1"></a>sd1[k]<span class="ot">=</span><span class="fu">sd</span>(result1)</span>
<span id="cb39-27"><a href="#cb39-27" tabindex="-1"></a>sd2[k]<span class="ot">=</span><span class="fu">sd</span>(result2)</span>
<span id="cb39-28"><a href="#cb39-28" tabindex="-1"></a>sd3[k]<span class="ot">=</span><span class="fu">sd</span>(result3)</span>
<span id="cb39-29"><a href="#cb39-29" tabindex="-1"></a>}</span>
<span id="cb39-30"><a href="#cb39-30" tabindex="-1"></a>meansd1<span class="ot">=</span><span class="fu">mean</span>(sd1)</span>
<span id="cb39-31"><a href="#cb39-31" tabindex="-1"></a>meansd2<span class="ot">=</span><span class="fu">mean</span>(sd2)</span>
<span id="cb39-32"><a href="#cb39-32" tabindex="-1"></a>meansd3<span class="ot">=</span><span class="fu">mean</span>(sd3)</span>
<span id="cb39-33"><a href="#cb39-33" tabindex="-1"></a>meanbias1<span class="ot">=</span><span class="fu">mean</span>(mean1)</span>
<span id="cb39-34"><a href="#cb39-34" tabindex="-1"></a>meanbias2<span class="ot">=</span><span class="fu">mean</span>(mean2)</span>
<span id="cb39-35"><a href="#cb39-35" tabindex="-1"></a>meanbias3<span class="ot">=</span><span class="fu">mean</span>(mean3)<span class="co">#1000次模拟的均值与偏差结果</span></span>
<span id="cb39-36"><a href="#cb39-36" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(meanbias1,meanbias2,meanbias3))</span></code></pre></div>
<pre><code>## [1] 0.6016700 0.2176525 0.1029946</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(meansd1,meansd2,meansd3))</span></code></pre></div>
<pre><code>## [1] 2.2307656 0.8151841 0.4992966</code></pre>
<p>在重复次数(<span class="math inline">\(m=10^3\)</span>)下，我们得到输出的<span class="math inline">\(Bootstrap\)</span>方法估计量偏差与标准差的估计值如下，并与题中给出的偏差与标准差的理论值进行对比。</p>
<table>
<caption>Theoretical and simulation value of standard error and
bias</caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th>sample size</th>
<th>sd(theoretical)</th>
<th>sd(simulation)</th>
<th>bias(theoretical)</th>
<th>bias(simulation)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5</td>
<td>1.443</td>
<td>2.231</td>
<td>0.5</td>
<td>0.602</td>
</tr>
<tr class="even">
<td>10</td>
<td>0.786</td>
<td>0.815</td>
<td>0.222</td>
<td>0.218</td>
</tr>
<tr class="odd">
<td>20</td>
<td>0.496</td>
<td>0.499</td>
<td>0.105</td>
<td>0.103</td>
</tr>
</tbody>
</table>
<p>可以发现在样本量较大时标准差的理论值与真实值之间均比较接近，样本量较小时标准差的理论值与真实值偏差较大,对于均值也有类似结果。</p>
</div>
</div>
<div id="question-1" class="section level1">
<h1>Question</h1>
<div id="question1-4" class="section level2">
<h2>Question1</h2>
<p>参考练习7.4，请用标准正态方法、基本方法、百分位方法和 BCa
方法计算平均故障间隔时间 <span class="math inline">\(\frac{1}{\lambda}\)</span> 的 95%
Bootstrap方法置信区间，并解释它们输出结果不同的原因。</p>
</div>
<div id="question2-4" class="section level2">
<h2>Question2</h2>
<p>请参考练习
7.7。求偏差和标准误差的Jackknife方法的偏差和标准误差估计值。</p>
</div>
<div id="question3-3" class="section level2">
<h2>Question3</h2>
<p>在例 7.18 中，我们使用了 “留一法”（n 折）交叉验证来选择最佳拟合模型。
请使用两两交叉验证(留二法)来比较并拟合最优模型。</p>
</div>
</div>
<div id="answer-4" class="section level1">
<h1>Answer</h1>
<div id="answer1-4" class="section level2">
<h2>Answer1</h2>
<p>由指数分布的知识我们可以得到，样本均值<span class="math inline">\(\mathbb{E}X\)</span>是<span class="math inline">\(\frac{1}{\lambda}\)</span>的MLE估计。我们可以
据此利用boot包中的构建</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a><span class="fu">attach</span>(aircondit)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e3</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>data1<span class="ot">=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>,<span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) {<span class="fu">mean</span>(x[i])}</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span>ci.bca<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>data1,<span class="at">statistic=</span>boot.mean ,<span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];ci.bca[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>}</span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm :&#39;</span>,<span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]) ,<span class="fu">mean</span>( ci.norm[,<span class="dv">2</span>])))</span></code></pre></div>
<pre><code>## norm : 34.26171 181.8866</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;basic :&#39;</span>,<span class="fu">c</span>(<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]) ,<span class="fu">mean</span>( ci.basic[,<span class="dv">2</span>])))</span></code></pre></div>
<pre><code>## basic : 24.65525 169.5041</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;perc :&#39;</span>,<span class="fu">c</span>(<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]) ,<span class="fu">mean</span>( ci.perc[,<span class="dv">2</span>])))</span></code></pre></div>
<pre><code>## perc : 46.66258 191.5114</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;BCa :&#39;</span>,<span class="fu">c</span>(<span class="fu">mean</span>(ci.bca[,<span class="dv">1</span>]) ,<span class="fu">mean</span>( ci.bca[,<span class="dv">2</span>])))</span></code></pre></div>
<pre><code>## BCa : 56.93188 228.1216</code></pre>
<p>我们可以得到四种方法的置信区间结果，可以看到Bca方法无论是在置信区间的左端点还是右端点都在四种方法最大，可能受到了比较大的偏差校正作用影响。而标准正态置信区间和百分位数置信区间相对在四种方法中
置信区间既不偏大也不偏大，基本方法受较大的数据值的影响较小，置信区间的左端点与右端点在四种方法中都偏小。</p>
</div>
<div id="answer2-4" class="section level2">
<h2>Answer2</h2>
<p>根据练习7.7，我们需要对于5*5的得分数据样本的协方差阵计算其最大特征值所占所有特征值之和比例的
Jackknife估计值。其中估计量的形式如下表述：</p>
<p><span class="math display">\[
\hat{\theta}=\frac{\hat{\lambda}_1}{\sum_{j=1}^5 \hat{\lambda}_j}
\]</span> 我们给出如下的算法过程</p>
<p>Input:维数为88*5的得分数据score data</p>
<ol style="list-style-type: decimal">
<li><p>每次减少一列1*5的样本，重复88次。再通过剩下84*5的样本的协方差矩阵计算出总体协方差阵的MLE估计<span class="math inline">\(\hat{\Sigma}_i(i=1\ldots88)\)</span></p></li>
<li><p>利用<span class="math inline">\(\hat{\Sigma}_i\)</span>计算出五个特征值的估计值<span class="math inline">\(\hat{\lambda_{1,i}},\ldots\hat{\lambda_{5,i}}\)</span>,并得到第i个<span class="math inline">\(\hat{\theta_i}=\frac{\hat{\lambda}_{1,i}}{\sum_{j=1}^5
\hat{\lambda}_{j,i}}\)</span>估计量的值</p></li>
<li><p>最后利用Jackknife对应的偏差与标准差公式进行计算即可
Output:对应的偏差与标准差的估计值</p></li>
</ol>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a><span class="fu">attach</span>(scor)</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>sample1<span class="ot">=</span>scor</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>realcov<span class="ot">=</span><span class="fu">cov</span>(sample1)</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>realeigresult<span class="ot">=</span><span class="fu">eigen</span>(realcov)</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>realtheta<span class="ot">=</span>realeigresult<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(realeigresult<span class="sc">$</span>values)</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>realtheta</span></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>num<span class="ot">=</span><span class="fu">nrow</span>(sample1)</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>hattheta<span class="ot">=</span><span class="fu">numeric</span>(num)</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num)</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>{</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>  hatsigma<span class="ot">=</span><span class="fu">cov</span>(sample1[<span class="sc">-</span>i,])</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>  eigresult<span class="ot">=</span><span class="fu">eigen</span>(hatsigma)</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>  hattheta[i]<span class="ot">=</span>eigresult<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigresult<span class="sc">$</span>values)</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>}</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>bias<span class="ot">=</span>(num<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(hattheta)<span class="sc">-</span>realtheta)</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>se<span class="ot">=</span><span class="fu">sqrt</span>((num<span class="dv">-1</span>)<span class="sc">/</span>num<span class="sc">*</span><span class="fu">sum</span>((hattheta<span class="sc">-</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="at">times=</span>num)<span class="sc">*</span><span class="fu">mean</span>(hattheta)))<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p>由此我们可以得到Jackknife估计该估计量<span class="math inline">\(\hat{\theta}\)</span>的偏差为<span class="math inline">\(0.00107=1.07*10^{-3}\)</span>,标准差为0.0496</p>
</div>
<div id="answer3-2" class="section level2">
<h2>Answer3</h2>
<p>此时我们需要使用两两交叉验证的方法来比较与选择最优模型。我们可以先从ironslag数据集抽取的53个样本
中利用随机抽样的方法选取出两个样本作为验证集，剩下51个样本作为测试集.在测试集上拟合模型，并在
测试集上进行验证，获得两个回归的样本残差值并计算残差平方和进行比较，模拟重复次数为N=1000次。</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>n <span class="ot">=</span><span class="fu">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>e1 <span class="ot">=</span> e2 <span class="ot">=</span> e3 <span class="ot">=</span> e4<span class="ot">=</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>num<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="dv">1000</span>)){</span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>  sample1<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">size=</span><span class="dv">2</span>,<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>  sample1<span class="ot">=</span><span class="fu">sort</span>(sample1)</span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>  j<span class="ot">=</span>sample1[<span class="dv">1</span>]</span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a>  k<span class="ot">=</span>sample1[<span class="dv">2</span>]</span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a>    y<span class="ot">=</span>magnetic[<span class="sc">-</span>j]</span>
<span id="cb54-16"><a href="#cb54-16" tabindex="-1"></a>    y<span class="ot">=</span>y[<span class="sc">-</span>k]</span>
<span id="cb54-17"><a href="#cb54-17" tabindex="-1"></a>    x <span class="ot">=</span> chemical[<span class="sc">-</span>j]</span>
<span id="cb54-18"><a href="#cb54-18" tabindex="-1"></a>    x<span class="ot">=</span>x[<span class="sc">-</span>k]</span>
<span id="cb54-19"><a href="#cb54-19" tabindex="-1"></a>    num<span class="ot">=</span>num<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb54-20"><a href="#cb54-20" tabindex="-1"></a>    J1 <span class="ot">=</span><span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb54-21"><a href="#cb54-21" tabindex="-1"></a>    yhat1 <span class="ot">=</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">c</span>(chemical[k],chemical[j])</span>
<span id="cb54-22"><a href="#cb54-22" tabindex="-1"></a>    e1[i]<span class="ot">=</span>(<span class="fu">c</span>(magnetic[k],magnetic[j]) <span class="sc">-</span> yhat1)[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb54-23"><a href="#cb54-23" tabindex="-1"></a>    <span class="sc">+</span>(<span class="fu">c</span>(magnetic[k],magnetic[j]) <span class="sc">-</span> yhat1)[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb54-24"><a href="#cb54-24" tabindex="-1"></a>    J2 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb54-25"><a href="#cb54-25" tabindex="-1"></a>    yhat2 <span class="ot">=</span> <span class="fu">c</span>(J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] </span>
<span id="cb54-26"><a href="#cb54-26" tabindex="-1"></a>              <span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb54-27"><a href="#cb54-27" tabindex="-1"></a>   J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[j] </span>
<span id="cb54-28"><a href="#cb54-28" tabindex="-1"></a>   <span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[j]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb54-29"><a href="#cb54-29" tabindex="-1"></a>    e2[i] <span class="ot">=</span> (<span class="fu">c</span>(magnetic[k],magnetic[j]) <span class="sc">-</span> yhat2)[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb54-30"><a href="#cb54-30" tabindex="-1"></a>    <span class="sc">+</span>(<span class="fu">c</span>(magnetic[k],magnetic[j]) <span class="sc">-</span> yhat2)[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb54-31"><a href="#cb54-31" tabindex="-1"></a>    J3 <span class="ot">=</span><span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb54-32"><a href="#cb54-32" tabindex="-1"></a>    logyhat3 <span class="ot">=</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb54-33"><a href="#cb54-33" tabindex="-1"></a>    otherlogyhat3 <span class="ot">=</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[j]</span>
<span id="cb54-34"><a href="#cb54-34" tabindex="-1"></a>    yhat3 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">exp</span>(logyhat3),<span class="fu">exp</span>(otherlogyhat3))</span>
<span id="cb54-35"><a href="#cb54-35" tabindex="-1"></a>    e3[i] <span class="ot">=</span> (<span class="fu">c</span>(magnetic[k],magnetic[j]) <span class="sc">-</span> yhat3)[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb54-36"><a href="#cb54-36" tabindex="-1"></a>    <span class="sc">+</span>(<span class="fu">c</span>(magnetic[k],magnetic[j]) <span class="sc">-</span> yhat3)[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb54-37"><a href="#cb54-37" tabindex="-1"></a>    J4 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb54-38"><a href="#cb54-38" tabindex="-1"></a>    logyhat4 <span class="ot">=</span>J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k])</span>
<span id="cb54-39"><a href="#cb54-39" tabindex="-1"></a>    otherlogyhat4 <span class="ot">=</span>J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[j])</span>
<span id="cb54-40"><a href="#cb54-40" tabindex="-1"></a>    yhat4 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">exp</span>(logyhat3),<span class="fu">exp</span>(otherlogyhat4))</span>
<span id="cb54-41"><a href="#cb54-41" tabindex="-1"></a>    e4[i] <span class="ot">=</span>(<span class="fu">c</span>(magnetic[k],magnetic[j]) <span class="sc">-</span> yhat4)[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb54-42"><a href="#cb54-42" tabindex="-1"></a>    <span class="sc">+</span>(<span class="fu">c</span>(magnetic[k],magnetic[j]) <span class="sc">-</span> yhat4)[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb54-43"><a href="#cb54-43" tabindex="-1"></a>  }</span>
<span id="cb54-44"><a href="#cb54-44" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>( <span class="fu">c</span>(<span class="fu">mean</span>(e1), <span class="fu">mean</span>(e2), <span class="fu">mean</span>(e3), <span class="fu">mean</span>(e4))))</span></code></pre></div>
<pre><code>## [1] 23.14664 20.18482 23.18544 23.18544</code></pre>
<p>那么我们可以得到第二个模型在leave-two-out方法下拟合原数据的残差平方和达到最小，也就是选用二次
函数形式拟合效果最好。 # Question</p>
</div>
<div id="question1-5" class="section level2">
<h2>Question1</h2>
<p>请参考离散分布样本情形的Metropolis-Hastings采样算法的平稳性证明，证明平稳性质在连续分布样本的情形下也成立</p>
</div>
<div id="question2-5" class="section level2">
<h2>Question2</h2>
<p>利用检验同分布的置换检验来完成双样本的 Cramer-von Mises
检验，并应用在例 8.1 和例 8.2 中的数据中。</p>
</div>
<div id="question3-4" class="section level2">
<h2>Question3</h2>
<p>第 6.4 节中的Count 5同方差检验是基于极值点的最大数目建立的 。例 6.15
表明Count
5标准不适用于样本量不等的情况。请构建一个基于最大极值点数目的同方差置换检验，使得该检验能在样本量不相等的情况下也适用。</p>
</div>
</div>
<div id="answer-5" class="section level1">
<h1>Answer</h1>
<div id="answer1-5" class="section level2">
<h2>Answer1</h2>
<p>在连续样本的情形下给出的提议分布记为<span class="math inline">\(g(r
\mid s)\)</span>，对应的概率密度分布函数为<span class="math inline">\(f(x)\)</span>， 每次循环得到的接受概率为 <span class="math inline">\(\alpha(s, r)=\min \left\{\frac{f(r) g(s \mid
r)}{f(s) g(r \mid s)}, 1\right\}\)</span>. 此时转移概率密度的形式如下
<span class="math display">\[
K(r, s)=\alpha(r, s) g(s \mid r)+I(s=r)\left[1-\int \alpha(r, s) g(s
\mid r)\right] \text {. }
\]</span></p>
<p>我们想要证明平稳性，即需要证明<span class="math inline">\(K(s, r)
f(s)=K(r, s) f(r)\)</span>.</p>
<p>由于<span class="math inline">\(\alpha(s, r)=\min \left\{\frac{f(r)
g(s \mid r)}{f(s) g(r \mid s)}, 1\right\}\)</span>，<span class="math inline">\(\alpha(r, s)=\min \left\{\frac{f(s) g(r \mid
s)}{f(r) g(s \mid r)}, 1\right\}\)</span>,所以当 <span class="math inline">\(\alpha(s,r)&lt;1\)</span>时，<span class="math inline">\(\frac{f(r) g(s \mid r)}{f(s) g(r \mid
s)}\)</span>&lt;1,此时<span class="math inline">\(\frac{f(s) g(r \mid
s)}{f(r) g(s \mid r)}\)</span>&gt;1,<span class="math inline">\(\alpha(r,s)=1\)</span>，反之若<span class="math inline">\(\alpha(r,s)&lt;1\)</span>也能得到<span class="math inline">\(\alpha(s,r)=1\)</span>。代入计算得到： <span class="math display">\[ k(s,r)f(s)=\{
\begin{array}{c}
g(r|s)f(s)+I(s=r)[f(s)-\int g(r|s)f(s)] \quad if \quad\alpha(s,r)=1 \\
g(s|r)f(r)+I(s=r)[f(r)-\int g(s|r)f(r)] \quad if \quad\alpha(s,r)&lt;1
\end{array}
\]</span></p>
<p><span class="math display">\[ k(r,s)f(r)=\{
\begin{array}{c}
g(r|s)f(s)+I(s=r)[f(s)-\int g(r|s)f(s)] \quad if \quad\alpha(r,s)&lt;1
\\
g(s|r)f(r)+I(s=r)[f(r)-\int g(s|r)f(r)] \quad if \quad\alpha(r,s)=1
\end{array}
\]</span></p>
<p>$$当<span class="math inline">\(\alpha(s,r)=1\)</span>时，我们可以得到<span class="math inline">\(\alpha(r,s)=1\)</span>或<span class="math inline">\(\alpha(r,s)&lt;1\)</span>，当<span class="math inline">\(\alpha(r,s)&lt;1\)</span>时显然两者相等，而当<span class="math inline">\(\alpha(r,s)=1\)</span>时，我们有<span class="math inline">\(g(r|s)f(s)=g(s|r)f(r)\)</span>，<span class="math inline">\(I(s=r)[f(s)-\int g(r|s)f(s)]=I(s=r)[f(r)-\int
g(s\|r)f(r)]\)</span>，等式仍然成立。 当<span class="math inline">\(\alpha(s,r)&lt;1\)</span>时,我们可以得到<span class="math inline">\(\alpha(r,s)=1\)</span>,平稳性成立。</p>
</div>
<div id="answer2-5" class="section level2">
<h2>Answer2</h2>
<p>我们给出如下的算法过程：对于给定的样本<span class="math inline">\(X=(x_1,x_2,\ldots x_n),y=(y_1,y_2,\ldots
y_m)\)</span>, 我们先根据样本计算出分别依赖于样本<span class="math inline">\(X,Y\)</span>的两个经验分布函数<span class="math inline">\(F_n(x)\)</span>与<span class="math inline">\(G_m(y)\)</span>， 再利用置换检验将样本<span class="math inline">\(X,Y\)</span>合并后随机重复<span class="math inline">\(N=10^4\)</span>次采样，根据统计量的具体形式得出
Cramer-von Mises在原假设下的大样本近似零分布，再根据样本的取值计算出
Cramer-von Mises检验统计量的值。
根据样本的检验统计量以及检验的分布计算出检验p值。建立相应的函数后再代入两个例子中的该组数据进行计算应用。</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>myfunction<span class="ot">=</span><span class="cf">function</span>(x,y)<span class="co">#建立函数</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>{</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>  numx<span class="ot">=</span><span class="fu">length</span>(x)</span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>  numy<span class="ot">=</span><span class="fu">length</span>(y)</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>  num<span class="ot">=</span>numx<span class="sc">+</span>numy<span class="co">#计算样本的维数</span></span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>  z<span class="ot">=</span><span class="fu">c</span>(x,y)</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>  R<span class="ot">=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span></span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>  result<span class="ot">=</span><span class="fu">numeric</span>(R)</span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>  power<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R)</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>  {</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>    sample1<span class="ot">=</span><span class="fu">sample</span>(z,num,<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>    pro1<span class="ot">=</span>sample1[<span class="dv">1</span><span class="sc">:</span>numx]</span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>    pro2<span class="ot">=</span>sample1[numx<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>num]</span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a>   fun1<span class="ot">=</span><span class="fu">ecdf</span>(pro1)</span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>    fun2<span class="ot">=</span><span class="fu">ecdf</span>(pro2)<span class="co">#获取经验分布函数</span></span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a>    result1<span class="ot">=</span><span class="fu">fun1</span>(z)</span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a>    result2<span class="ot">=</span><span class="fu">fun2</span>(z)</span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a>    result[i]<span class="ot">=</span>numx<span class="sc">*</span>numy<span class="sc">/</span>((numx<span class="sc">+</span>numy)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sum</span>((result1<span class="sc">-</span>result2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a>    </span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a>  }</span>
<span id="cb56-24"><a href="#cb56-24" tabindex="-1"></a> funreal1<span class="ot">=</span><span class="fu">ecdf</span>(x)</span>
<span id="cb56-25"><a href="#cb56-25" tabindex="-1"></a> funreal2<span class="ot">=</span><span class="fu">ecdf</span>(y)</span>
<span id="cb56-26"><a href="#cb56-26" tabindex="-1"></a> result0<span class="ot">=</span>numx<span class="sc">*</span>numy<span class="sc">/</span>((numx<span class="sc">+</span>numy)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sum</span>((<span class="fu">funreal1</span>(z)<span class="sc">-</span><span class="fu">funreal2</span>(z))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-27"><a href="#cb56-27" tabindex="-1"></a> <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">c</span>(result,result0)<span class="sc">&gt;</span>result0))</span>
<span id="cb56-28"><a href="#cb56-28" tabindex="-1"></a>}</span>
<span id="cb56-29"><a href="#cb56-29" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb56-30"><a href="#cb56-30" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb56-31"><a href="#cb56-31" tabindex="-1"></a>y0<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb56-32"><a href="#cb56-32" tabindex="-1"></a></span>
<span id="cb56-33"><a href="#cb56-33" tabindex="-1"></a><span class="fu">detach</span>(chickwts)<span class="co">#选取数据并代入函数</span></span>
<span id="cb56-34"><a href="#cb56-34" tabindex="-1"></a>resultall<span class="ot">=</span><span class="fu">myfunction</span>(x0,y0)</span>
<span id="cb56-35"><a href="#cb56-35" tabindex="-1"></a><span class="fu">print</span>(resultall)</span></code></pre></div>
<pre><code>## [1] 0.4056594</code></pre>
<p>我们可以得到，利用例子中chickwts的数据集中的数据进行两样本Cramer-von
Mises 置换检验,最终输出的检验p值为0.406，
无法说明两组数据之间确实存在显著差异。可能是该方法统计量相比t统计量更倾向于接受原假设。</p>
</div>
<div id="answer3-3" class="section level2">
<h2>Answer3</h2>
<p>此时我们需要建立一个在样本数量不相等的情况下也可使用的
基于最大极值点数目的双样本同方差置换检验。不妨设样本<span class="math inline">\(X\)</span>的样本容量为m，样本<span class="math inline">\(Y\)</span>的样本容量为n。
首先我们和之前一样对样本<span class="math inline">\(X,Y\)</span>进行中心化处理，即减去自身的均值。我们再将中心化处理后的<span class="math inline">\(X,Y\)</span>数据合并，在合并得到的样本容量为<span class="math inline">\(m+n\)</span>的混合样本中有放回的抽取同样
容量为<span class="math inline">\(m+n\)</span>的样本，划分成新的<span class="math inline">\(X^{&#39;},Y^{&#39;}\)</span>样本，进行多次Count5检验并考虑其经验第一类错误。</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10000</span>)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>maxout <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)))</span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>}</span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y,N) {</span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>x<span class="ot">=</span>x<span class="sc">-</span><span class="fu">mean</span>(x)</span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>y<span class="ot">=</span>y<span class="sc">-</span><span class="fu">mean</span>(y)<span class="co">#中心化</span></span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">c</span>(x,y)</span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>result0<span class="ot">=</span><span class="fu">numeric</span>(N)</span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">sample</span>(z,<span class="fu">length</span>(z),<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a>X<span class="ot">=</span>z[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)]</span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a>Y<span class="ot">=</span>z[(<span class="fu">length</span>(x)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(z)]</span>
<span id="cb58-18"><a href="#cb58-18" tabindex="-1"></a>X<span class="ot">=</span>X<span class="sc">-</span><span class="fu">mean</span>(X)</span>
<span id="cb58-19"><a href="#cb58-19" tabindex="-1"></a>Y<span class="ot">=</span>Y<span class="sc">-</span><span class="fu">mean</span>(Y)</span>
<span id="cb58-20"><a href="#cb58-20" tabindex="-1"></a>outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb58-21"><a href="#cb58-21" tabindex="-1"></a>outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb58-22"><a href="#cb58-22" tabindex="-1"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb58-23"><a href="#cb58-23" tabindex="-1"></a>result0[i]<span class="ot">=</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))}</span>
<span id="cb58-24"><a href="#cb58-24" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">mean</span>(result0))</span>
<span id="cb58-25"><a href="#cb58-25" tabindex="-1"></a>}</span>
<span id="cb58-26"><a href="#cb58-26" tabindex="-1"></a>n1 <span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb58-27"><a href="#cb58-27" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb58-28"><a href="#cb58-28" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb58-29"><a href="#cb58-29" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb58-30"><a href="#cb58-30" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb58-31"><a href="#cb58-31" tabindex="-1"></a>tests <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, <span class="at">expr =</span> {</span>
<span id="cb58-32"><a href="#cb58-32" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb58-33"><a href="#cb58-33" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb58-34"><a href="#cb58-34" tabindex="-1"></a><span class="fu">count5test</span>(x, y,<span class="dv">1000</span>)</span>
<span id="cb58-35"><a href="#cb58-35" tabindex="-1"></a>} )</span>
<span id="cb58-36"><a href="#cb58-36" tabindex="-1"></a>alphahat <span class="ot">&lt;-</span> <span class="fu">mean</span>(tests)</span>
<span id="cb58-37"><a href="#cb58-37" tabindex="-1"></a><span class="fu">print</span>(alphahat)</span></code></pre></div>
<pre><code>## [1] 0.030654</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>stat <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a><span class="fu">maxout</span>(x, y)</span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>})</span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cumsum</span>(<span class="fu">table</span>(stat)) <span class="sc">/</span> m)<span class="co">#同样本容量检验</span></span></code></pre></div>
<pre><code>##     1     2     3     4     5     6     7     8     9 
## 0.202 0.583 0.812 0.920 0.969 0.991 0.998 0.999 1.000</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>n1 <span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>tests <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, <span class="at">expr =</span> {</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a><span class="fu">count5test</span>(x, y,<span class="dv">1000</span>)</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>} )</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>alphahat <span class="ot">&lt;-</span> <span class="fu">mean</span>(tests)</span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a><span class="fu">print</span>(alphahat)</span></code></pre></div>
<pre><code>## [1] 0.036099</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>stat <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a><span class="fu">maxout</span>(x, y)</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>})</span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cumsum</span>(<span class="fu">table</span>(stat)) <span class="sc">/</span> m)<span class="co">#异样本容量检验</span></span></code></pre></div>
<pre><code>##     1     2     3     4     5     6     7     8     9 
## 0.225 0.599 0.798 0.917 0.967 0.989 0.998 0.999 1.000</code></pre>
<p>那么我们可以得到在样本数量一致的情形下此时的经验Type I
Error=0.010与期望的经验第一类错误1-0.969=0.031非常接近。
在样本量相差不大时也有较好表现，但在样本量相差较大时表现不太好。 #
Question</p>
</div>
<div id="question1-6" class="section level2">
<h2>Question1</h2>
<p>考虑一个混合的Logistics回归模型<span class="math inline">\(P\left(Y=1
\mid X_1, X_2, X_3\right)=\frac{\exp \left(a+b_1 X_1+b_2 X_2+b_3
X_3\right)}{1+\exp \left(a+b_1 X_1+b_2 X_2+b_3 X_3\right)}\)</span>,
此时 <span class="math inline">\(X_1 \sim P(1), X_2 \sim
\operatorname{Exp}(1)\)</span> 且 <span class="math inline">\(X_3 \sim
B(1,0.5)\)</span>.</p>
</div>
<div id="question2-6" class="section level2">
<h2>Question2</h2>
<p>建立随机游走形式的 Metropolis
采样方法并应用于生成标准拉普拉斯分布（见练习
3.2）。对于其中的增量，采用正态分布进行模拟。比较在使用不同方差的提议分布下生成的马氏链。同时，计算每个马氏链的接受率。</p>
</div>
<div id="question3-5" class="section level2">
<h2>Question3</h2>
<p>使用Gibbs采样方法生成均值为零，标准差为单位阵,相关性为 0.9
的二元正态链 <span class="math inline">\((X_t,Y_t)\)</span>。
在舍弃一组合适的预烧样本后，绘制生成的样本图像。
利用简单线性回归模型<span class="math inline">\(Y= β_0 + β_1X\)</span>
对样本进行拟合 ，并检验模型残差的正态性和方差的恒定性。</p>
</div>
<div id="question4-3" class="section level2">
<h2>Question4</h2>
<p>请参考例 9.1。使用 Gelman-Rubin 方法控制马氏链的收敛性。 也可以使用
coda [212] 软件包通过 Gelman-Rubin 方法检测马氏链的收敛性。提示： 参见
coda 函数 gelman.diag、gelman.plot、as.mcmc 和 mcmc.list
帮助完成任务。</p>
</div>
</div>
<div id="answer-6" class="section level1">
<h1>Answer</h1>
<div id="answer1-6" class="section level2">
<h2>Answer1</h2>
<p>我们先如题所示设定这些参数的值，利用获得的分布信息生成样本，并将其线性组合代入Logit函数
构建逻辑回归模型。 <span class="math display">\[
g(\alpha)=\frac{1}{N} \sum_{i=1}^N \frac{1}{1+e^{-\alpha-\beta_1 x_{1
i}-\beta_1 x_{2 i}}}-f_0
\]</span> 我们再通过以上函数对于<span class="math inline">\(P(D=1)-f_0\)</span>进行估计，求解以上方程的根并绘制出对应的曲线图。</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span>; b1 <span class="ot">&lt;-</span> <span class="dv">0</span>; b2 <span class="ot">&lt;-</span> <span class="dv">1</span>;b3<span class="ot">=</span><span class="sc">-</span><span class="dv">1</span>; f1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">rpois</span>(N,<span class="at">lambda =</span> <span class="dv">1</span>)</span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N,<span class="at">rate=</span><span class="dv">1</span>); x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,N,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha,f0){</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a><span class="fu">mean</span>(p) <span class="sc">-</span> f0<span class="co">#逻辑回归部分</span></span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a>}</span>
<span id="cb66-10"><a href="#cb66-10" tabindex="-1"></a>result<span class="ot">=</span><span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb66-11"><a href="#cb66-11" tabindex="-1"></a>solution1 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">0</span>),<span class="at">f0=</span>f1[<span class="dv">1</span>])</span>
<span id="cb66-12"><a href="#cb66-12" tabindex="-1"></a>result[<span class="dv">1</span>]<span class="ot">=</span><span class="fu">round</span>(<span class="fu">unlist</span>(solution1),<span class="dv">5</span>)[<span class="dv">1</span>]</span>
<span id="cb66-13"><a href="#cb66-13" tabindex="-1"></a>solution2 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">0</span>),<span class="at">f0=</span>f1[<span class="dv">2</span>])</span>
<span id="cb66-14"><a href="#cb66-14" tabindex="-1"></a>result[<span class="dv">2</span>]<span class="ot">=</span><span class="fu">round</span>(<span class="fu">unlist</span>(solution2),<span class="dv">5</span>)[<span class="dv">1</span>]</span>
<span id="cb66-15"><a href="#cb66-15" tabindex="-1"></a>solution3 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">0</span>),<span class="at">f0=</span>f1[<span class="dv">3</span>])</span>
<span id="cb66-16"><a href="#cb66-16" tabindex="-1"></a>result[<span class="dv">3</span>]<span class="ot">=</span><span class="fu">round</span>(<span class="fu">unlist</span>(solution3),<span class="dv">5</span>)[<span class="dv">1</span>]</span>
<span id="cb66-17"><a href="#cb66-17" tabindex="-1"></a>solution4 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">0</span>),<span class="at">f0=</span>f1[<span class="dv">4</span>])</span>
<span id="cb66-18"><a href="#cb66-18" tabindex="-1"></a>result[<span class="dv">4</span>]<span class="ot">=</span><span class="fu">round</span>(<span class="fu">unlist</span>(solution4),<span class="dv">5</span>)[<span class="dv">1</span>]</span>
<span id="cb66-19"><a href="#cb66-19" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## [1]  -3.16730  -6.07182  -8.72417 -11.25369</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="fu">log</span>(f1),result,<span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmtv+QOgCQZgCQkGaQ2/+2ZgC2tma2/7a2///bkDrb////tmb/25D//7b//9v////nM8IsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHoElEQVR4nO2di3ajNhRFiZO0jZu0oRNCHP//fxYhe2zQFQeEHpdw9lqTlWGwBHuuXkYS1ZlMUpW+AO1QEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBAZEHVZiglKG5y6aAgAAUBygragKbCETS/DixF8SKm3VBxQdqDqLwg5UGkQZBqQyoEaS5mOgQpDiItgtQGkRpBWoNIkSCdQZRZEPgWQaEhTREUP5cIKBOkr5hpE6QuiPQJUhZECgXpCiKVgjQFkU5BioJIqyA1htQK0lLM9ApSEkSaBakIItWCNASRckHlg0i7oOJBpF9QYUMbEFS2mG1BUNEg2oaggkGUSFB9+Dh/PVfVw3uU5EI+EIk0gno/f3RyTsfXCMnZT5RRlETQ6fjSSXoyvzaPn6uTW/OZ1SwXdPrbFpu2ixIPJm6+316mzgq62RKGwgU1fkF99DTRI6hIMVsqqL492Xrxn3w6Hj76EGp9tXTonWY3FB5B07RW4tM4lcXTj53ryKxoI/2gSB9NmVvAZV3q6VjJ3T6bU9FCQafjrZBMVNKWVIKyBtEWI+icM4g2KihfEAW0YsfyRaxPIY+i4Aia6EhHzTdxGvEycU6sx32cNPlOJpJBUbigdSEU6dbSGwoXNDUWi5gvSie1omBBp2P5ImZTSqsovBXzDNNj55s5rfDE9YzFhMQSKvoRglIGUYAg84Vqo6mI9emlUhQgqH78/Hp+0tAPSpzismTvKunXc1u96ugHDZJMoihMkHmso6MflDzRkCL2dDo+fqrpBw1SLVhy7yvp6uH9+22Vn2TNTvR0f0gzf5dwqQvdiqDYSYcI6srY42c98VgsZr4haRcZx9xObB/eG1NJrzKkZIQZManfJ5ovUs0DZYXN/F3y0dIP6wcZQUEdxfVPVmfnlDsdJ4LqVYOxDF8FxskiuA5qKs/UqMj5rskj65OBYSs2Mbkucr6lc/mB/aBBNvkeUA7qoPXoe3S89vODVmw9+aYfrAyikEp63TPVhflGYFVeKZ/NR8k3BmuC6IdX0uuz24mg8CDai6BgRfsRFJjnngQFBdGuBIVkm0jQ9xvoChQStDyI0ghqrusUWt+ChVKCFitKIuhuuBZ3MUscFuWdRNDdcC3qcqhYLAmiPUbQeYmiVHXQJYQU1kELLyBRKwbn6RUXNDeIdtYPGjDrGvYsaFYQ7VrQHEWZBeV7cDgXdCGJ+kFw2Z0aQSiI0kTQ9xv6PlaPIKAo2WAVTEDTJGjyalLVQS14Mq1L0EQQ7bwVu+G7IAq6snaT9IA7SrtmNT6iIgq6R7gqChrgBhEFjRgroiCHauJvsz8W+Sp0MQgiCpKoxF9nfybyJWjkFkQU5OGqiIK8VHc/Z58eOfcNQEEACgJQEKCYoM1QSNCiTBYdTpjGJBQEoCAABQEoCEBBAAoCUBCAggCbGRuUgoIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQHSC2q821oJ26XZ1Q7ObHXz4knn4OVVXu7M7UY6OHEdkyQXZLYdlN/X1grr8vpXTLpndid6duEVDjddbu6E97o7+vW8fI+k1IL6jSvFFQz9xp/jg+JiYTvnT97g0T1qMxvvG2430PQttZ0gSx0kCmoe/3Evt5HCRA4r+0/PznxJWZANYu+rB/1kEdQI19XdtVAH1X9V7lsW28Ovo+fdi7UQVmIRuwhavgliBkGtdHOm2LiCzJbf3V2PTm/M6jRPMZW0tUJ1bKufgF0iMxUxR8XUpp/jisgGoFQ9iUXGvm95bM5W0koFuTfSVys+QePGxlbEUhMkpXCJFUdnXVWHX7NeBTogjyDn5hpfH6Y/e1Qp29gRqmqxhE1Vx19/Lt7BLrUgq0be6sP9/5fPtnuGCGmI/ZqpHDU288aCZ/GC1Ir1TfT47MaThhwmYh3UdygDWvkMRaz2lSSxBpHPboXG/+x9F1otnW0GMSqHGluHggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBNAmyPOyzu+3VzNlxjxx76ewnJZP9AlkI4Kap+tkoNOxn7HQrnol9QK2IcgcvcwSumynb0IqCyoF/Z7tUlfVw79m0urhw0y2P3y01ctlalTAXKggNAoyk3X7CU9mKlRrZvWYeVXX2LoICpkMFYJCQXYuWSfATqarH9776mckKGRZQQgKBdlb735aFa0R9OoIkqdIx0etoO6X5iqoP0JBZmrwCyMI4NZBDeuge9iKAZx+0OE/Y6n7MxK0136Qy72cG54hSXw0C7o0Xv1SwfFaqN2OxQa0v9e7jIde+x3Nq4OCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAf4HOAeXbvzpO5MAAAAASUVORK5CYII=" /><!-- --></p>
<p>最终可以发现，随着<span class="math inline">\(-log(f_0)\)</span>的取值的增加，得到的估计值<span class="math inline">\(\hat{\alpha}\)</span>的不断减少，且
两者的变化近似线性关系。</p>
</div>
<div id="answer2-6" class="section level2">
<h2>Answer2</h2>
<p>对于<code>Laplace</code>分布，考虑其概率密度函数 <span class="math inline">\(f(x)=\frac{1}{2}\exp\{-\left\lvert x \right\rvert
\} \,,x\in\mathbb{R}\)</span>，累计分布函数为 <span class="math display">\[
F(x)=\begin{cases}
\frac{1}{2}e^x &amp;\text{x &lt; 0或x=0}\\
1-\frac{1}{2}e^{-x} &amp;\text{x&gt;0}
\end{cases}
\]</span>
那么我们考虑当提议分布选取不同方差下的正态分布时，比较生成的马氏链以及对应的接受频率。</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>dlaplace<span class="ot">=</span><span class="cf">function</span>(x)</span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>{</span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)))<span class="co">#Laplace分布对应的密度函数</span></span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>}</span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a>rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma, x0, N) {</span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb69-10"><a href="#cb69-10" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb69-12"><a href="#cb69-12" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb69-13"><a href="#cb69-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb69-14"><a href="#cb69-14" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb69-15"><a href="#cb69-15" tabindex="-1"></a><span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">dlaplace</span>(y) <span class="sc">/</span> <span class="fu">dlaplace</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb69-16"><a href="#cb69-16" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb69-17"><a href="#cb69-17" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb69-18"><a href="#cb69-18" tabindex="-1"></a>k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb69-19"><a href="#cb69-19" tabindex="-1"></a>}<span class="co">#Metropolis方法采样</span></span>
<span id="cb69-20"><a href="#cb69-20" tabindex="-1"></a>}</span>
<span id="cb69-21"><a href="#cb69-21" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb69-22"><a href="#cb69-22" tabindex="-1"></a>}</span>
<span id="cb69-23"><a href="#cb69-23" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb69-24"><a href="#cb69-24" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb69-25"><a href="#cb69-25" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb69-26"><a href="#cb69-26" tabindex="-1"></a>rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb69-27"><a href="#cb69-27" tabindex="-1"></a>rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb69-28"><a href="#cb69-28" tabindex="-1"></a>rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb69-29"><a href="#cb69-29" tabindex="-1"></a>rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n,sigma[<span class="dv">4</span>],x0,N)<span class="co">#四条马氏链结果</span></span>
<span id="cb69-30"><a href="#cb69-30" tabindex="-1"></a> <span class="fu">print</span>(<span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k))<span class="co">#四种方差下的拒绝次数</span></span></code></pre></div>
<pre><code>## [1]   34  333  970 1832</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a> dat<span class="ot">=</span><span class="fu">cbind</span>(rw1<span class="sc">$</span>x[<span class="dv">1001</span><span class="sc">:</span><span class="dv">2000</span>],rw2<span class="sc">$</span>x[<span class="dv">1001</span><span class="sc">:</span><span class="dv">2000</span>],rw3<span class="sc">$</span>x[<span class="dv">1001</span><span class="sc">:</span><span class="dv">2000</span>],rw4<span class="sc">$</span>x[<span class="dv">1001</span><span class="sc">:</span><span class="dv">2000</span>])</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a> p_line<span class="ot">=</span><span class="fu">ggplot</span>(<span class="fu">as.data.frame</span>(dat))<span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1001</span><span class="sc">:</span><span class="dv">2000</span>,<span class="at">y=</span>dat[,<span class="dv">1</span>]),<span class="at">color=</span><span class="st">&#39;blue&#39;</span>)<span class="sc">+</span>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1001</span><span class="sc">:</span><span class="dv">2000</span>,<span class="at">y=</span>dat[,<span class="dv">2</span>]),<span class="at">color=</span><span class="st">&#39;red&#39;</span>)<span class="sc">+</span>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1001</span><span class="sc">:</span><span class="dv">2000</span>,<span class="at">y=</span>dat[,<span class="dv">3</span>]),<span class="at">color=</span><span class="st">&#39;yellow&#39;</span>)<span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1001</span><span class="sc">:</span><span class="dv">2000</span>,<span class="at">y=</span>dat[,<span class="dv">4</span>]),<span class="at">color=</span><span class="st">&#39;green&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">x=</span> <span class="st">&#39;times&#39;</span>,<span class="at">y=</span><span class="st">&#39;value&#39;</span>)</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a> <span class="co">#方差由小到大依次是蓝红黄绿四条折线图</span></span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a> </span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>p_line</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>我们除去前1000个预烧样本，利用MCMC方法在四种不同方差下的提议分布(正态分布)构造出对应的标准拉普拉斯分布,画出相应的时序图,其中方差由小到大依次是蓝红黄绿四条折线图，
可以看到方差较大时，得到的样本分布基本在0左右波动，并且随着提议分布的方差不断增大，拒绝的频率也在不断增大。
我们可以看出在四种方差中选择方差为0.5或2为较优选择。</p>
</div>
<div id="answer3-4" class="section level2">
<h2>Answer3</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10000</span>)</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code></pre></div>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">8</span> <span class="co">#correlation</span></span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2) <span class="co">#initialize</span></span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a>X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb76-20"><a href="#cb76-20" tabindex="-1"></a>X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb76-21"><a href="#cb76-21" tabindex="-1"></a>}</span>
<span id="cb76-22"><a href="#cb76-22" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb76-23"><a href="#cb76-23" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]<span class="co">#生成二元正态的样本</span></span>
<span id="cb76-24"><a href="#cb76-24" tabindex="-1"></a>lmmodel<span class="ot">=</span><span class="fu">lm</span>(x0[,<span class="dv">2</span>]<span class="sc">~</span>x0[,<span class="dv">1</span>])</span>
<span id="cb76-25"><a href="#cb76-25" tabindex="-1"></a><span class="fu">summary</span>(lmmodel)<span class="co">#回归</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x0[, 2] ~ x0[, 1])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.88983 -0.41587 -0.00764  0.41522  2.01869 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.011675   0.009449  -1.236    0.217    
## x0[, 1]     -0.804078   0.009417 -85.389   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5969 on 3998 degrees of freedom
## Multiple R-squared:  0.6459, Adjusted R-squared:  0.6458 
## F-statistic:  7291 on 1 and 3998 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>res<span class="ot">=</span>lmmodel<span class="sc">$</span>residuals</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a><span class="fu">qqnorm</span>(res)<span class="co">#qq图</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">ks.test</span>(res,<span class="st">&#39;pnorm&#39;</span>)<span class="co">#KS正态性检验</span></span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  res
## D = 0.12495, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="fu">gqtest</span>(lmmodel)<span class="co">#Goldfeld-Quandt检验</span></span></code></pre></div>
<pre><code>## 
##  Goldfeld-Quandt test
## 
## data:  lmmodel
## GQ = 1.0498, df1 = 1998, df2 = 1998, p-value = 0.1387
## alternative hypothesis: variance increases from segment 1 to 2</code></pre>
<p>我们先通过Gibbs采样的方法迭代得到去除前1000组预烧样本的样本容量n=4000的二元正态链，并做出<span class="math inline">\(Y\)</span>对于<span class="math inline">\(X\)</span>的回归，
得到的回归结果我们画出残差的qq图并使用kolmogorov进行正态检验，并利用GQ检验验证同方差性，最终得到的残差具有一定
厚尾性，KS检验的结果拒绝了残差的正态性，而GQ检验的结果验证了残差的同方差性。</p>
</div>
<div id="answer4-3" class="section level2">
<h2>Answer4</h2>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="fu">return</span> (<span class="dv">0</span>)</span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a><span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a><span class="fu">return</span>((x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a>}</span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb83-12"><a href="#cb83-12" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb83-13"><a href="#cb83-13" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-14"><a href="#cb83-14" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb83-15"><a href="#cb83-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb83-16"><a href="#cb83-16" tabindex="-1"></a>xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb83-17"><a href="#cb83-17" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb83-18"><a href="#cb83-18" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb83-19"><a href="#cb83-19" tabindex="-1"></a>den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb83-20"><a href="#cb83-20" tabindex="-1"></a><span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb83-21"><a href="#cb83-21" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb83-22"><a href="#cb83-22" tabindex="-1"></a>k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb83-23"><a href="#cb83-23" tabindex="-1"></a>}</span>
<span id="cb83-24"><a href="#cb83-24" tabindex="-1"></a>}</span>
<span id="cb83-25"><a href="#cb83-25" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2000</span>)</span>
<span id="cb83-26"><a href="#cb83-26" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb83-27"><a href="#cb83-27" tabindex="-1"></a>x1[<span class="dv">1</span>]<span class="ot">=</span><span class="fu">rchisq</span>(<span class="dv">1</span>,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb83-28"><a href="#cb83-28" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb83-29"><a href="#cb83-29" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb83-30"><a href="#cb83-30" tabindex="-1"></a>xt <span class="ot">&lt;-</span> x1[i<span class="dv">-1</span>]</span>
<span id="cb83-31"><a href="#cb83-31" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb83-32"><a href="#cb83-32" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb83-33"><a href="#cb83-33" tabindex="-1"></a>den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb83-34"><a href="#cb83-34" tabindex="-1"></a><span class="cf">if</span>(u1[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) x1[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb83-35"><a href="#cb83-35" tabindex="-1"></a>x1[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb83-36"><a href="#cb83-36" tabindex="-1"></a>k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb83-37"><a href="#cb83-37" tabindex="-1"></a>}</span>
<span id="cb83-38"><a href="#cb83-38" tabindex="-1"></a>}</span>
<span id="cb83-39"><a href="#cb83-39" tabindex="-1"></a><span class="fu">gelman.diag</span>(<span class="fu">mcmc.list</span>(<span class="fu">as.mcmc</span>(x),<span class="fu">as.mcmc</span>(x1)),<span class="at">confidence =</span> <span class="fl">0.95</span>,<span class="at">transform =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]       1.01       1.03</code></pre>
<p>我们利用之前的MH采样方法生成了两组对应的
服从Rayleigh分布的马氏链，并用coda包中的函数gelman.diag完成收敛性的检验工作，
最终得到的下界接近于1，这也说明了所得马氏链的收敛性 # Question</p>
</div>
<div id="question1-7" class="section level2">
<h2>Question1</h2>
<p>设 <span class="math inline">\(x_1 \ldots x_n.i.d. Exp
(\lambda)\)</span>．因为某种原因，只知道 <span class="math inline">\(X_i\)</span>落在某个区间<span class="math inline">\((u_i , v_i )\)</span>，其中 <span class="math inline">\(u_i&lt;v_i\)</span>
是两个非随机的已知常数，这种数据称为区间删失数据。</p>
<p>(1）试分别直接极大化观测数据的似然函数与采用 EM 算法求解<span class="math inline">\(\lambda\)</span>的 MLE ，证明 EM
算法收敛于观测数据的 MLE ，且具有线性的收敛速度</p>
<p>(2）<span class="math inline">\(设(u_i , v_i ), c =1,\ldots n
=10\)</span>的观测值为(11,12),(8.9), (27.28),</p>
<p>(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3),试分别编程实现上述两种算法以得到
<span class="math inline">\(\lambda\)</span> MLE 的数值解．</p>
<p>提示：观测数据的似然函数为 <span class="math inline">\(L(\lambda)=
\Pi_{i=1}^n P_{\lambda}( u_i\leq X_i\leq v_i )\)</span>.</p>
</div>
<div id="question2-7" class="section level2">
<h2>Question2</h2>
<p>在Morra博弈中，如果从报酬矩阵的每一个条目中减去一个常数，或者将报酬矩阵的每一个条目乘以一个正常数，那么最优策略集都不会发生变化。
然而，单纯形法的最终结果可能是另一个基本可行点（也是最优点）。 计算 B
&lt;- A + 2，并找出博弈 B 的解，并验证它是原博弈 A 的一个极值点
(11.12)-(11.15)。 同时求出博弈 A 和博弈 B 的值。</p>
</div>
</div>
<div id="answer-7" class="section level1">
<h1>Answer</h1>
<div id="answer1-7" class="section level2">
<h2>Answer1</h2>
<p>(1)我们先如题中方法计算观测数据的似然函数 为 <span class="math display">\[L(\lambda)= P_{\lambda}( u_i\leq X_i\leq v_i
)=\Pi_{i=1}^n (e^{-\lambda u_i}-e^{-\lambda v_i})\]</span></p>
<p>令其梯度为0，我们可以得到</p>
<p><span class="math display">\[
\frac{\partial log(L)}{\partial \lambda}=0\Longrightarrow \sum_{i=1}^n
\frac{-u_i e^{-\lambda u_i}+v_i e^{-\lambda v_i}}{e^{-\lambda
u_i}-e^{-\lambda v_i}}=0
\]</span></p>
<p>此时MLE的估计量<span class="math inline">\(\lambda\)</span>并不存在显式的表达。</p>
<p>以下是我们采用EM算法求解参数<span class="math inline">\(\lambda\)</span>估计问题的具体步骤。
我们需要不断使用E步与M步两个步骤对于参数<span class="math inline">\(\lambda\)</span>的取值以及隐变量的条件期望进行迭代优化。</p>
<p>在E步中，我们主要计算给定观测数据和当前参数估计下隐变量的条件期望。
我们设定隐变量<span class="math inline">\(z_i\)</span>为指示变量，表示样本 <span class="math inline">\(x_i\)</span>
是否来自指数分布。在指数分布的情况下，我们可以将 <span class="math inline">\(z_i\)</span> 视为一个二元变量，其条件期望为: <span class="math display">\[
E\left(z_k \mid x_k, \lambda\right)=P\left(z_k=1 \mid x_i,
\lambda\right)=\frac{(e^{-\lambda u_k}-e^{-\lambda v_k})}{\sum_{i=1}^n
(e^{-\lambda u_i}-e^{-\lambda v_i})}
\]</span></p>
<p>在M步中，我们则通过最大化完整数据（包括隐变量）的对数似然函数，对于参数<span class="math inline">\(\lambda\)</span>的估计进行更新。具体我们使用 <span class="math inline">\({E}\)</span>
步中计算得到的条件期望，通过最大化完整数据的对数似然函数来更新参数 <span class="math inline">\(\lambda\)</span></p>
<p>那么当对数似然函数为: <span class="math display">\[
log L(\lambda)=\sum_{i=1}^n \log f\left(x_i ;
\lambda\right)=\sum_{i=1}^n \log(P\left(z_k=1 \mid x_i,
\lambda\right)*\lambda_{old})
\]</span></p>
<p>我们在迭代次数趋于无穷的情况下<span class="math inline">\(\hat{\lambda}=\lambda_{old}\)</span>时通过对对数似然函数求偏导并令导数等于零，解出更新的
<span class="math inline">\(\lambda\)</span>:<br />
<span class="math display">\[
    \frac{\partial L}{\partial \lambda}=0\Longrightarrow \sum_{i=1}^n
\frac{-u_i e^{-\lambda u_i}+v_i e^{-\lambda v_i}}{e^{-\lambda
u_i}-e^{-\lambda v_i}}=0
    \]</span></p>
<p>因而我们可以知道EM 算法收敛于观测数据的 MLE</p>
<p>(2)\
我们先输入以上数据，并根据(1)中说明的方法流程分别利用极大似然估计方法以及EM算法分别估计出参数<span class="math inline">\(\lambda\)</span>的取值。</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>A<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">12</span>,</span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>            <span class="dv">8</span>,<span class="dv">9</span>,</span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a>           <span class="dv">27</span>,<span class="dv">28</span>,</span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a>           <span class="dv">13</span>,<span class="dv">14</span>,</span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a>           <span class="dv">16</span>,<span class="dv">17</span>,</span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a>           <span class="dv">0</span>,<span class="dv">1</span>,</span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a>           <span class="dv">23</span>,<span class="dv">24</span>,</span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a>           <span class="dv">10</span>,<span class="dv">11</span>,</span>
<span id="cb85-11"><a href="#cb85-11" tabindex="-1"></a>           <span class="dv">24</span>,<span class="dv">25</span>,</span>
<span id="cb85-12"><a href="#cb85-12" tabindex="-1"></a>           <span class="dv">2</span>,<span class="dv">3</span>),<span class="dv">2</span>,<span class="dv">10</span>)</span>
<span id="cb85-13"><a href="#cb85-13" tabindex="-1"></a>A<span class="ot">=</span><span class="fu">t</span>(A)</span>
<span id="cb85-14"><a href="#cb85-14" tabindex="-1"></a>fx<span class="ot">=</span><span class="cf">function</span>(x)<span class="co">#LogML函数</span></span>
<span id="cb85-15"><a href="#cb85-15" tabindex="-1"></a>{f0<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb85-16"><a href="#cb85-16" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb85-17"><a href="#cb85-17" tabindex="-1"></a>{</span>
<span id="cb85-18"><a href="#cb85-18" tabindex="-1"></a>  f0<span class="ot">=</span>f0<span class="sc">+</span>(<span class="sc">-</span>A[i,<span class="dv">1</span>]<span class="sc">*</span><span class="fu">exp</span>({<span class="sc">-</span>x<span class="sc">*</span>A[i,<span class="dv">1</span>]})<span class="sc">+</span>A[i,<span class="dv">2</span>]<span class="sc">*</span></span>
<span id="cb85-19"><a href="#cb85-19" tabindex="-1"></a>           <span class="fu">exp</span>({<span class="sc">-</span>x<span class="sc">*</span>A[i,<span class="dv">2</span>]}))<span class="sc">/</span>(<span class="fu">exp</span>({<span class="sc">-</span>x<span class="sc">*</span>A[i,<span class="dv">1</span>]})<span class="sc">-</span><span class="fu">exp</span>({<span class="sc">-</span>x<span class="sc">*</span>A[i,<span class="dv">2</span>]}))</span>
<span id="cb85-20"><a href="#cb85-20" tabindex="-1"></a>}</span>
<span id="cb85-21"><a href="#cb85-21" tabindex="-1"></a>  f0</span>
<span id="cb85-22"><a href="#cb85-22" tabindex="-1"></a>}</span>
<span id="cb85-23"><a href="#cb85-23" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(fx,</span>
<span id="cb85-24"><a href="#cb85-24" tabindex="-1"></a><span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span><span class="dv">10</span>)</span>
<span id="cb85-25"><a href="#cb85-25" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(out1<span class="sc">$</span>root,out1<span class="sc">$</span>f.root),<span class="dv">4</span>)<span class="co">#MLE估计结果展示</span></span></code></pre></div>
<pre><code>## [1] 0.0720 0.0102</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="co">#E-step</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>E_step <span class="ot">&lt;-</span> <span class="cf">function</span>(x, lambda) {</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>  p_z_given_x <span class="ot">&lt;-</span> lambda <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> x) <span class="sc">/</span> (lambda <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> x) <span class="sc">+</span> lambda)</span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>  <span class="fu">return</span>(p_z_given_x)</span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a>}</span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a><span class="co"># M-step</span></span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a>M_step <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p_z_given_x) {</span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a>  lambda_new <span class="ot">&lt;-</span> <span class="fu">sum</span>(p_z_given_x) <span class="sc">/</span> <span class="fu">sum</span>(x)</span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a>  <span class="fu">return</span>(lambda_new)</span>
<span id="cb87-11"><a href="#cb87-11" tabindex="-1"></a>}</span>
<span id="cb87-12"><a href="#cb87-12" tabindex="-1"></a></span>
<span id="cb87-13"><a href="#cb87-13" tabindex="-1"></a>EM_algorithm <span class="ot">&lt;-</span> <span class="cf">function</span>(x, lambda_initial, <span class="at">tol =</span> <span class="fl">1e-6</span>, <span class="at">max_iter =</span> <span class="dv">1000</span>) {</span>
<span id="cb87-14"><a href="#cb87-14" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> lambda_initial</span>
<span id="cb87-15"><a href="#cb87-15" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb87-16"><a href="#cb87-16" tabindex="-1"></a>    <span class="co"># E-step</span></span>
<span id="cb87-17"><a href="#cb87-17" tabindex="-1"></a>    p_z_given_x <span class="ot">&lt;-</span> <span class="fu">E_step</span>(x, lambda)</span>
<span id="cb87-18"><a href="#cb87-18" tabindex="-1"></a>    </span>
<span id="cb87-19"><a href="#cb87-19" tabindex="-1"></a>    <span class="co"># M-step</span></span>
<span id="cb87-20"><a href="#cb87-20" tabindex="-1"></a>    lambda_new <span class="ot">&lt;-</span> <span class="fu">M_step</span>(x, p_z_given_x)</span>
<span id="cb87-21"><a href="#cb87-21" tabindex="-1"></a>    </span>
<span id="cb87-22"><a href="#cb87-22" tabindex="-1"></a>    <span class="co"># Check for convergence</span></span>
<span id="cb87-23"><a href="#cb87-23" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(lambda_new <span class="sc">-</span> lambda) <span class="sc">&lt;</span> tol) {</span>
<span id="cb87-24"><a href="#cb87-24" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb87-25"><a href="#cb87-25" tabindex="-1"></a>    }</span>
<span id="cb87-26"><a href="#cb87-26" tabindex="-1"></a>    </span>
<span id="cb87-27"><a href="#cb87-27" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb87-28"><a href="#cb87-28" tabindex="-1"></a>  }</span>
<span id="cb87-29"><a href="#cb87-29" tabindex="-1"></a>  </span>
<span id="cb87-30"><a href="#cb87-30" tabindex="-1"></a>  <span class="fu">return</span>(lambda)</span>
<span id="cb87-31"><a href="#cb87-31" tabindex="-1"></a>}</span>
<span id="cb87-32"><a href="#cb87-32" tabindex="-1"></a>result<span class="ot">=</span><span class="fu">apply</span>(A,<span class="dv">1</span>,mean)</span>
<span id="cb87-33"><a href="#cb87-33" tabindex="-1"></a>x<span class="ot">=</span>result</span>
<span id="cb87-34"><a href="#cb87-34" tabindex="-1"></a>lambda_initial <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb87-35"><a href="#cb87-35" tabindex="-1"></a>estimated_lambda <span class="ot">&lt;-</span> <span class="fu">EM_algorithm</span>(x, lambda_initial)</span>
<span id="cb87-36"><a href="#cb87-36" tabindex="-1"></a>estimated_lambda </span></code></pre></div>
<pre><code>## [1] 0.02893923</code></pre>
<p>最终可以发现，MLE方法得到的参数<span class="math inline">\(\lambda\)</span>的估计值为0.0720,EM算法得到的参数<span class="math inline">\(\lambda\)</span>为0.0289，应该是在EM算法部分的程序过程存在一定的问题。</p>
</div>
<div id="answer2-7" class="section level2">
<h2>Answer2</h2>
<p>在Morra博弈中我们在报酬矩阵上对于每个元素加二，并不改变之前得到的最优策略集，将改变后的新报酬矩阵代入算法进行验证。</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a><span class="co">#solve the two player zero-sum game by simplex method</span></span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a><span class="co">#optimize for player 1, then player 2</span></span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a><span class="co">#maximize v subject to ...</span></span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a><span class="co">#let x strategies 1:m, and put v as extra variable</span></span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a><span class="co">#A1, the &lt;= constraints</span></span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a>min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A <span class="co">#so that v &gt;= 0</span></span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a>max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">/</span> <span class="fu">max</span>(A)</span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb89-14"><a href="#cb89-14" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb89-15"><a href="#cb89-15" tabindex="-1"></a>it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb89-16"><a href="#cb89-16" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb89-17"><a href="#cb89-17" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n)) <span class="co">#constraints &lt;=</span></span>
<span id="cb89-18"><a href="#cb89-18" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb89-19"><a href="#cb89-19" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>))) <span class="co">#constraints sum(x)=1</span></span>
<span id="cb89-20"><a href="#cb89-20" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb89-21"><a href="#cb89-21" tabindex="-1"></a>sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb89-22"><a href="#cb89-22" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb89-23"><a href="#cb89-23" tabindex="-1"></a><span class="co">#the ’solution’ is [x1,x2,...,xm | value of game]</span></span>
<span id="cb89-24"><a href="#cb89-24" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb89-25"><a href="#cb89-25" tabindex="-1"></a><span class="co">#minimize v subject to ...</span></span>
<span id="cb89-26"><a href="#cb89-26" tabindex="-1"></a><span class="co">#let y strategies 1:n, with v as extra variable</span></span>
<span id="cb89-27"><a href="#cb89-27" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb89-28"><a href="#cb89-28" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m)) <span class="co">#constraints &lt;=</span></span>
<span id="cb89-29"><a href="#cb89-29" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb89-30"><a href="#cb89-30" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>))) <span class="co">#constraints sum(y)=1</span></span>
<span id="cb89-31"><a href="#cb89-31" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb89-32"><a href="#cb89-32" tabindex="-1"></a>sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb89-33"><a href="#cb89-33" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">FALSE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb89-34"><a href="#cb89-34" tabindex="-1"></a>soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A,</span>
<span id="cb89-35"><a href="#cb89-35" tabindex="-1"></a><span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb89-36"><a href="#cb89-36" tabindex="-1"></a><span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb89-37"><a href="#cb89-37" tabindex="-1"></a><span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span> min.A)</span>
<span id="cb89-38"><a href="#cb89-38" tabindex="-1"></a>soln</span>
<span id="cb89-39"><a href="#cb89-39" tabindex="-1"></a>}</span>
<span id="cb89-40"><a href="#cb89-40" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb89-41"><a href="#cb89-41" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb89-42"><a href="#cb89-42" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb89-43"><a href="#cb89-43" tabindex="-1"></a><span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb89-44"><a href="#cb89-44" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb89-45"><a href="#cb89-45" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb89-46"><a href="#cb89-46" tabindex="-1"></a><span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb89-47"><a href="#cb89-47" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb89-48"><a href="#cb89-48" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb89-49"><a href="#cb89-49" tabindex="-1"></a>A<span class="ot">=</span>A<span class="sc">+</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">81</span>),<span class="dv">9</span>,<span class="dv">9</span>)<span class="co">#A=A+2</span></span>
<span id="cb89-50"><a href="#cb89-50" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co">#needed for simplex function</span></span>
<span id="cb89-51"><a href="#cb89-51" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(A)</span>
<span id="cb89-52"><a href="#cb89-52" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(<span class="at">gameA=</span>s<span class="sc">$</span>x, <span class="at">gameB=</span>s<span class="sc">$</span>y), <span class="dv">7</span>)<span class="co">#value of gameA and gameB</span></span></code></pre></div>
<pre><code>##        gameA     gameB
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">25</span><span class="sc">/</span><span class="dv">61</span>, <span class="dv">0</span>, <span class="dv">20</span><span class="sc">/</span><span class="dv">61</span>, <span class="dv">0</span>, <span class="dv">16</span><span class="sc">/</span><span class="dv">61</span>, <span class="dv">0</span>,<span class="dv">0</span>),<span class="dv">7</span>)</span></code></pre></div>
<pre><code>## [1] 0.0000000 0.0000000 0.4098361 0.0000000 0.3278689 0.0000000 0.2622951
## [8] 0.0000000 0.0000000</code></pre>
<p>可以验证得到的gameB的解正是书中(11.15)式对应的最优解，gameA 与
gameB的值也在上述输出结果中进行了展示，均为c(0, 0, 25/61, 0, 20/61, 0,
16/61, 0,0). # Question</p>
</div>
<div id="question1-8" class="section level2">
<h2>Question1</h2>
<p>为什么我们使用unlist()函数来将列表型list数据转化为原子向量型数据，为什么as.factor()函数在此时会无法使用。</p>
</div>
<div id="question2-8" class="section level2">
<h2>Question2</h2>
<p>1.dim() 应用于向量时会返回什么结果？\ 2.如果 is.matrix(x) 为
TRUE，is.array(x) 将返回什么结果？</p>
</div>
<div id="question3-6" class="section level2">
<h2>Question3</h2>
<p>1.dataframe可以有 0 行吗？那么 0 列呢？</p>
<p>2.当 as.matrix() 应用于具有不同类型dataframe时，会发生什么？</p>
</div>
<div id="question4-4" class="section level2">
<h2>Question4</h2>
<p>下面的函数可以将向量进行缩放至 [0, 1]中去.
如何将其应用于dataframe的每一列中？
如何将它应用到dataframe的每一数值列中？</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="question5-2" class="section level2">
<h2>Question5</h2>
<p>使用 vapply() 来 1. 计算数值dataframe中每一列的标准差。\
2.计算dataframe中每一列数值的标准差。(提示：您需要使用 vapply()函数
两次）。</p>
</div>
<div id="question6-1" class="section level2">
<h2>Question6</h2>
<p>考虑以下的一个二元分布， <span class="math display">\[
f(x, y) \propto\left(\begin{array}{l}
n \\
x
\end{array}\right) y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1, \ldots, n, 0
\leq y \leq 1 .
\]</span></p>
<p>可以看到在固定三个变量 <span class="math inline">\(a, b,
n\)</span>的情形下,x,y的条件分布分别为 <span class="math inline">\(\operatorname{Binomial}(n, y)\)</span> 与 <span class="math inline">\(\operatorname{Beta}(x+a, n-x+b)\)</span>. 使用
Gibbs 采样方法来生成服从目标联合概率密度<span class="math inline">\(f(x,
y)\)</span>的一条马氏链.
且运用microbenchmark函数比较两种语言代码的运行时间</p>
</div>
</div>
<div id="answer-8" class="section level1">
<h1>Answer</h1>
<div id="answer1-8" class="section level2">
<h2>Answer1</h2>
<p>unlist函数的主要作用是展平列表，也就是说该函数会递归地从列表中提取元素，从而得到一个一维向量型数据。
而as.vector()是函数一个通用的强制转换函数，但它并不专门设计用于处理列表，不会像unlist()那样递归提取元素，而是会保留列表结构，并不会得到真正的atomic向量。</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a>my_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="fu">list</span>(<span class="at">c =</span> <span class="dv">2</span>, <span class="at">d =</span> <span class="dv">3</span>), <span class="at">e =</span> <span class="dv">4</span>,<span class="at">f=</span><span class="fu">list</span>(<span class="at">g=</span><span class="dv">5</span>))</span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a><span class="co"># 使用unlist()</span></span>
<span id="cb94-4"><a href="#cb94-4" tabindex="-1"></a>result_unlist <span class="ot">&lt;-</span> <span class="fu">unlist</span>(my_list)</span>
<span id="cb94-5"><a href="#cb94-5" tabindex="-1"></a><span class="fu">print</span>(result_unlist)</span></code></pre></div>
<pre><code>##   a b.c b.d   e f.g 
##   1   2   3   4   5</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="co"># 使用as.vector()</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>result_as_vector <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(my_list)</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a><span class="fu">print</span>(result_as_vector)</span></code></pre></div>
<pre><code>## $a
## [1] 1
## 
## $b
## $b$c
## [1] 2
## 
## $b$d
## [1] 3
## 
## 
## $e
## [1] 4
## 
## $f
## $f$g
## [1] 5</code></pre>
</div>
<div id="answer2-8" class="section level2">
<h2>Answer2</h2>
<ol style="list-style-type: decimal">
<li>dim() 应用于向量时会返回Null，对应维数为空</li>
</ol>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">vector</span>(<span class="at">length=</span>5L)</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(a))</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(b))</span></code></pre></div>
<pre><code>## NULL</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>如果 is.matrix(x) 为 TRUE，那么 is.array(x) 也将返回
TRUE。因为矩阵是一个特殊的二维数组，array范围比matrix更广。</li>
</ol>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a><span class="fu">is.matrix</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="fu">is.array</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="answer3-5" class="section level2">
<h2>Answer3</h2>
<ol style="list-style-type: decimal">
<li>dataframe是一种特殊的list类型的列表，可以有零行，但由于其为列表类数据，不能有零列。我们可以创建零行的dataframe，但零列的dataframe会报错。</li>
</ol>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a>a<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [1] X1 X2 X3 X4 X5
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>当 as.matrix()
应用于具有不同类型的DataFrame时，R会试着将DataFrame转换为一个矩阵。然而，由于矩阵要求所有元素具有相同的数据类型，因此在DataFrame的列具有不同的数据类型时，R会进行一些数据类型的转换，转化的次序如下：logical
&lt; integer &lt; double &lt; character &lt;
list，以使得整个矩阵具有统一的数据类型。</li>
</ol>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">a=</span><span class="dv">1</span>,<span class="at">b=</span><span class="fu">list</span>(<span class="at">c=</span><span class="dv">3</span>,<span class="at">d=</span><span class="dv">4</span>))</span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as.matrix</span>(a))</span></code></pre></div>
<pre><code>##      a b.c b.d
## [1,] 1   3   4</code></pre>
</div>
<div id="answer4-4" class="section level2">
<h2>Answer4</h2>
<p>要想将该函数其应用于dataframe的每一列，只需直接运用apply函数对每一列使用该函数进行操作即可，我们同样先考虑一个只含有数值数据的dataframe。</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>  <span class="at">A =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a>  <span class="at">B =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a>)</span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb110-6"><a href="#cb110-6" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-7"><a href="#cb110-7" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb110-8"><a href="#cb110-8" tabindex="-1"></a>}</span>
<span id="cb110-9"><a href="#cb110-9" tabindex="-1"></a><span class="co"># 使用apply()函数</span></span>
<span id="cb110-10"><a href="#cb110-10" tabindex="-1"></a></span>
<span id="cb110-11"><a href="#cb110-11" tabindex="-1"></a>result<span class="ot">&lt;-</span> <span class="fu">apply</span>(df1,  <span class="dv">2</span>,scale01)</span>
<span id="cb110-12"><a href="#cb110-12" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##        A         B
## [1,] 0.0 0.0000000
## [2,] 0.5 0.3333333
## [3,] 1.0 1.0000000</code></pre>
<p>而当我们只想将函数应用在其中的数值列时，我们需要先用is.numeric函数结合sapply函数对于是否是数值列进行判断，判断后再对选定的数值列使用给定函数进行相应的处理工作。</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>  <span class="at">A =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a>  <span class="at">B =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>),</span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a>  <span class="at">C=</span><span class="fu">c</span>(<span class="st">&quot;article&quot;</span>,<span class="st">&quot;subject&quot;</span>,<span class="st">&quot;lesson&quot;</span>)</span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a>)</span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a>columns <span class="ot">&lt;-</span> <span class="fu">sapply</span>(df1, is.numeric)</span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb112-8"><a href="#cb112-8" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb112-9"><a href="#cb112-9" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb112-10"><a href="#cb112-10" tabindex="-1"></a>}</span>
<span id="cb112-11"><a href="#cb112-11" tabindex="-1"></a></span>
<span id="cb112-12"><a href="#cb112-12" tabindex="-1"></a><span class="co"># 使用apply()函数</span></span>
<span id="cb112-13"><a href="#cb112-13" tabindex="-1"></a>result<span class="ot">&lt;-</span> <span class="fu">apply</span>(df1[,columns], <span class="dv">2</span>, scale01)</span>
<span id="cb112-14"><a href="#cb112-14" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##        A   B
## [1,] 0.0 0.0
## [2,] 0.5 0.5
## [3,] 1.0 1.0</code></pre>
</div>
<div id="answer5-2" class="section level2">
<h2>Answer5</h2>
<p>与上一题类似地，我们只需直接运用vapply函数对每一列使用求标准差即可</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>  <span class="at">A =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>  <span class="at">B =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>)</span>
<span id="cb114-5"><a href="#cb114-5" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" tabindex="-1"></a></span>
<span id="cb114-7"><a href="#cb114-7" tabindex="-1"></a><span class="co"># 使用vapply()函数</span></span>
<span id="cb114-8"><a href="#cb114-8" tabindex="-1"></a>result<span class="ot">&lt;-</span> <span class="fu">vapply</span>(df1, sd,<span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="at">sd=</span><span class="dv">0</span>))</span>
<span id="cb114-9"><a href="#cb114-9" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##        A        B 
## 1.000000 1.527525</code></pre>
<p>同样地，与上一题类似地，我们需要先用is.numeric函数结合vapply函数对于是否是数值列进行判断，判断后再对选定的数值列求标准差即可</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>  <span class="at">A =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a>  <span class="at">B =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>),</span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a>  <span class="at">C=</span><span class="fu">c</span>(<span class="st">&quot;article&quot;</span>,<span class="st">&quot;subject&quot;</span>,<span class="st">&quot;lesson&quot;</span>)</span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a>)</span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a>columns <span class="ot">&lt;-</span> <span class="fu">vapply</span>(df1, is.numeric,<span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="at">sd=</span><span class="dv">0</span>))</span>
<span id="cb116-7"><a href="#cb116-7" tabindex="-1"></a></span>
<span id="cb116-8"><a href="#cb116-8" tabindex="-1"></a></span>
<span id="cb116-9"><a href="#cb116-9" tabindex="-1"></a><span class="co"># 使用apply()函数</span></span>
<span id="cb116-10"><a href="#cb116-10" tabindex="-1"></a>result<span class="ot">&lt;-</span> <span class="fu">vapply</span>(df1[,columns],  sd,<span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="at">sd=</span><span class="dv">0</span>))</span>
<span id="cb116-11"><a href="#cb116-11" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as.vector</span>(result))</span></code></pre></div>
<pre><code>## [1] 1 1</code></pre>
</div>
<div id="answer6-1" class="section level2">
<h2>Answer6</h2>
<p>我们先考虑用R语言实现该过程</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb118-5"><a href="#cb118-5" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb118-6"><a href="#cb118-6" tabindex="-1"></a>funa<span class="ot">=</span><span class="cf">function</span>(a,b,n){</span>
<span id="cb118-7"><a href="#cb118-7" tabindex="-1"></a></span>
<span id="cb118-8"><a href="#cb118-8" tabindex="-1"></a></span>
<span id="cb118-9"><a href="#cb118-9" tabindex="-1"></a>x<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb118-10"><a href="#cb118-10" tabindex="-1"></a>y<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb118-11"><a href="#cb118-11" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb118-12"><a href="#cb118-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb118-13"><a href="#cb118-13" tabindex="-1"></a> </span>
<span id="cb118-14"><a href="#cb118-14" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb118-15"><a href="#cb118-15" tabindex="-1"></a>  </span>
<span id="cb118-16"><a href="#cb118-16" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb118-17"><a href="#cb118-17" tabindex="-1"></a>  </span>
<span id="cb118-18"><a href="#cb118-18" tabindex="-1"></a>  <span class="co"># 存储采样结果</span></span>
<span id="cb118-19"><a href="#cb118-19" tabindex="-1"></a> X[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb118-20"><a href="#cb118-20" tabindex="-1"></a>}</span>
<span id="cb118-21"><a href="#cb118-21" tabindex="-1"></a>X<span class="ot">=</span>X[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">5000</span>,]</span>
<span id="cb118-22"><a href="#cb118-22" tabindex="-1"></a><span class="fu">return</span>(X)</span>
<span id="cb118-23"><a href="#cb118-23" tabindex="-1"></a>}</span>
<span id="cb118-24"><a href="#cb118-24" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">funa</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>)</span>
<span id="cb118-25"><a href="#cb118-25" tabindex="-1"></a><span class="fu">print</span>(b[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,])</span></code></pre></div>
<pre><code>##       [,1]       [,2]
##  [1,]    6 0.54594625
##  [2,]    6 0.68359045
##  [3,]    7 0.41701812
##  [4,]    7 0.47683668
##  [5,]    3 0.17877716
##  [6,]    3 0.31469998
##  [7,]    2 0.04906491
##  [8,]    2 0.12033901
##  [9,]    1 0.07904688
## [10,]    0 0.12463524
## [11,]    0 0.06212662
## [12,]    0 0.15258151
## [13,]    2 0.43634091
## [14,]    2 0.24104555
## [15,]    2 0.27454705
## [16,]    5 0.56752856
## [17,]    3 0.27761471
## [18,]    3 0.26640125
## [19,]    5 0.58302386
## [20,]    6 0.62231901</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp<span class="op">;</span></span>
<span id="cb120-3"><a href="#cb120-3" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" tabindex="-1"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb120-5"><a href="#cb120-5" tabindex="-1"></a>NumericMatrix gibbsSampler<span class="op">(</span><span class="dt">int</span> N<span class="op">,</span> <span class="dt">int</span> burn<span class="op">,</span> <span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb120-6"><a href="#cb120-6" tabindex="-1"></a>  NumericMatrix X<span class="op">(</span>N<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb120-7"><a href="#cb120-7" tabindex="-1"></a>  </span>
<span id="cb120-8"><a href="#cb120-8" tabindex="-1"></a>  <span class="dt">int</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb120-9"><a href="#cb120-9" tabindex="-1"></a>  <span class="dt">double</span> y <span class="op">=</span> <span class="fl">0.5</span><span class="op">;</span></span>
<span id="cb120-10"><a href="#cb120-10" tabindex="-1"></a>  </span>
<span id="cb120-11"><a href="#cb120-11" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb120-12"><a href="#cb120-12" tabindex="-1"></a>    x <span class="op">=</span> R<span class="op">::</span>rbinom<span class="op">(</span><span class="dv">1</span><span class="op">,</span> y <span class="op">*</span> n<span class="op">);</span></span>
<span id="cb120-13"><a href="#cb120-13" tabindex="-1"></a>    y <span class="op">=</span> R<span class="op">::</span>rbeta<span class="op">(</span>x <span class="op">+</span> a<span class="op">,</span> <span class="op">(</span>n <span class="op">-</span> x<span class="op">)</span> <span class="op">+</span> b<span class="op">);</span></span>
<span id="cb120-14"><a href="#cb120-14" tabindex="-1"></a>    </span>
<span id="cb120-15"><a href="#cb120-15" tabindex="-1"></a>    X<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">)</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb120-16"><a href="#cb120-16" tabindex="-1"></a>    X<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">)</span> <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb120-17"><a href="#cb120-17" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb120-18"><a href="#cb120-18" tabindex="-1"></a>  </span>
<span id="cb120-19"><a href="#cb120-19" tabindex="-1"></a>  NumericMatrix result <span class="op">=</span> X<span class="op">(</span>Range<span class="op">(</span>burn<span class="op">,</span> N <span class="op">-</span> <span class="dv">1</span><span class="op">),</span> _<span class="op">);</span></span>
<span id="cb120-20"><a href="#cb120-20" tabindex="-1"></a>  <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb120-21"><a href="#cb120-21" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="fu">funa</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>), <span class="fu">gibbsSampler</span>(<span class="dv">5000</span>,<span class="dv">1000</span>, <span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">times =</span> <span class="dv">100</span>)</span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## Unit: microseconds
##                                expr     min        lq       mean     median
##                      funa(1, 1, 10) 15244.3 16532.601 22407.5339 18587.4010
##  gibbsSampler(5000, 1000, 1, 1, 10)   227.7   239.701   353.2591   246.1505
##         uq        max neval
##  25366.900 110195.401   100
##    271.951   7578.202   100</code></pre>
<p>我们可以看到在同样进行计算100次循环的过程中，使用一般R语言进行循环迭代所需的时间明显多于使用Rcpp所需的时间，Cpp
在循环过程中明显具有更高的效率</p>
</div>
<div id="备注" class="section level2">
<h2>备注</h2>
<div class="sourceCode" id="cb123"><pre class="sourceCode latex"><code class="sourceCode latex"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a>注：本次作业主要使用了一些R语言package（包括rmarkdown,rticles</span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a>,xtable等）,并在rticles的CTEX中文格式下进行编写。</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
